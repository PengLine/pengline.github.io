<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>余一叶知秋尽 | 余一叶知秋尽</title><meta name="author" content="余一叶知秋尽"><meta name="copyright" content="余一叶知秋尽"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="数字城管 - 智慧城市管理平台                        * {             margin: 0;             padding: 0;             box-sizing: border-box;         }          .container {             font-family:">
<meta property="og:type" content="website">
<meta property="og:title" content="余一叶知秋尽">
<meta property="og:url" content="https://pengline.github.io/turnkey/smart-city/digital-city-management.html">
<meta property="og:site_name" content="余一叶知秋尽">
<meta property="og:description" content="数字城管 - 智慧城市管理平台                        * {             margin: 0;             padding: 0;             box-sizing: border-box;         }          .container {             font-family:">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://pengline.github.io/img/butterfly-icon.webp">
<meta property="article:published_time" content="2026-01-17T12:10:51.412Z">
<meta property="article:modified_time" content="2026-01-17T12:10:51.412Z">
<meta property="article:author" content="余一叶知秋尽">
<meta property="article:tag" content="Java、AI、Python、Mysql、Redis、LLM、Lora、IOT、AIGC">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://pengline.github.io/img/butterfly-icon.webp"><script type="application/ld+json"></script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://pengline.github.io/turnkey/smart-city/digital-city-management.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"未找到符合您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":30,"languages":{"author":"作者: 余一叶知秋尽","link":"链接: ","source":"来源: 余一叶知秋尽","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: true,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '余一叶知秋尽',
  isHighlightShrink: false,
  isToc: false,
  pageType: 'page'
}</script><link rel="stylesheet" href="/css/font.css"><svg aria-hidden="true" style="position:absolute; overflow:hidden; width:0; height:0"><symbol id="icon-sun" viewBox="0 0 1024 1024"><path d="M960 512l-128 128v192h-192l-128 128-128-128H192v-192l-128-128 128-128V192h192l128-128 128 128h192v192z" fill="#FFD878" p-id="8420"></path><path d="M736 512a224 224 0 1 0-448 0 224 224 0 1 0 448 0z" fill="#FFE4A9" p-id="8421"></path><path d="M512 109.248L626.752 224H800v173.248L914.752 512 800 626.752V800h-173.248L512 914.752 397.248 800H224v-173.248L109.248 512 224 397.248V224h173.248L512 109.248M512 64l-128 128H192v192l-128 128 128 128v192h192l128 128 128-128h192v-192l128-128-128-128V192h-192l-128-128z" fill="#4D5152" p-id="8422"></path><path d="M512 320c105.888 0 192 86.112 192 192s-86.112 192-192 192-192-86.112-192-192 86.112-192 192-192m0-32a224 224 0 1 0 0 448 224 224 0 0 0 0-448z" fill="#4D5152" p-id="8423"></path></symbol><symbol id="icon-moon" viewBox="0 0 1024 1024"><path d="M611.370667 167.082667a445.013333 445.013333 0 0 1-38.4 161.834666 477.824 477.824 0 0 1-244.736 244.394667 445.141333 445.141333 0 0 1-161.109334 38.058667 85.077333 85.077333 0 0 0-65.066666 135.722666A462.08 462.08 0 1 0 747.093333 102.058667a85.077333 85.077333 0 0 0-135.722666 65.024z" fill="#FFB531" p-id="11345"></path><path d="M329.728 274.133333l35.157333-35.157333a21.333333 21.333333 0 1 0-30.165333-30.165333l-35.157333 35.157333-35.114667-35.157333a21.333333 21.333333 0 0 0-30.165333 30.165333l35.114666 35.157333-35.114666 35.157334a21.333333 21.333333 0 1 0 30.165333 30.165333l35.114667-35.157333 35.157333 35.157333a21.333333 21.333333 0 1 0 30.165333-30.165333z" fill="#030835" p-id="11346"></path></symbol></svg><meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/atom.xml" title="余一叶知秋尽" type="application/atom+xml">
</head><body><div id="web_bg" style="background: LightGray;"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src= "/img/20241215205335173426721579192.webp" data-lazy-src="/img/butterfly-icon.webp" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">52</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">236</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">41</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list-ul"></i><span> 归档</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类别</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签集</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-outdent"></i><span> AI</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/ai/aigc/"><i class="fa-fw fas fa-cubes"></i><span> AIGC 创意平台</span></a></li><li><a class="site-page child" href="/ai/agent/medical/"><i class="fa-fw fas fa-medkit"></i><span> 医疗问答Agent</span></a></li><li><a class="site-page child" href="https://github.com/HengLine/ai-stocks-agent"><i class="fa-fw fas fa-line-chart"></i><span> 股票分析Agent</span></a></li><li><a class="site-page child" href="/ai/agent/video/"><i class="fa-fw fas fa-cut"></i><span> 视频混剪Agent</span></a></li><li><a class="site-page child" href="https://github.com/HengLine/video-shot-agent"><i class="fa-fw fas fa-file-video"></i><span> 剧本分镜Agent</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list-ol"></i><span> 项目</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/turnkey/smart-city"><i class="fa-fw fas fa-building"></i><span> 智慧城市（IOT）</span></a></li><li><a class="site-page child" href="/turnkey/smart-security"><i class="fa-fw fas fa-check-circle"></i><span> 智慧安检（IOT）</span></a></li><li><a class="site-page child" href="/turnkey/tms"><i class="fa-fw fas fa-truck"></i><span> 物流运输（TMS）</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-cogs"></i><span> 工具</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/tools/json/"><i class="fa-fw fas fa-cog"></i><span> JSON 转换工具集</span></a></li><li><a class="site-page child" href="/tools/diagrams/mermaid"><i class="fa-fw fas fa-pie-chart"></i><span> 在线绘制 UML 图</span></a></li><li><a class="site-page child" href="/tools/image/compressor/"><i class="fa-fw fas fa-image"></i><span> 图像批量压缩大小</span></a></li><li><a class="site-page child" href="/tools/image/watermark/"><i class="fa-fw fas fa-image"></i><span> 图像批量添加水印</span></a></li><li><a class="site-page child" href="/tools/image/convert/"><i class="fa-fw fas fa-file-image"></i><span> 图像格式编码转换</span></a></li><li><a class="site-page child" href="/tools/video/cropping/"><i class="fa-fw fas fa-cut"></i><span> 视频时长范围裁剪</span></a></li><li><a class="site-page child" href="/tools/video/watermark/"><i class="fa-fw fas fa-video"></i><span> 视频加水印马赛克</span></a></li><li><a class="site-page child" href="/tools/download/"><i class="fa-fw fas fa-cloud-download"></i><span> 批量下载视频图片</span></a></li><li><a class="site-page child" href="/tools/docu/watermark/"><i class="fa-fw fas fa-file-pdf"></i><span> PDF 文档添加水印</span></a></li><li><a class="site-page child" href="/tools/docu/signature"><i class="fa-fw fas fa-file"></i><span> 文档在线手写签名</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-pencil-square"></i><span> 文学</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/literature/poems"><i class="fa-fw fas fa-align-center"></i><span> 三行诗集</span></a></li><li><a class="site-page child" href="/literature/classical"><i class="fa-fw fas fa-align-justify"></i><span> 诗词歌赋</span></a></li><li><a class="site-page child" href="/literature/modern"><i class="fa-fw fas fa-align-left"></i><span> 现代诗歌</span></a></li><li><a class="site-page child" href="/literature/journal"><i class="fa-fw fas fa-align-right"></i><span> 随心随笔</span></a></li><li><a class="site-page child" href="/literature/incomplete"><i class="fa-fw fas fa-columns"></i><span> 忘梦残句</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-commenting"></i><span> 交流</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></li><li><a class="site-page child" href="/messageboard/"><i class="fa-fw fas fa-paper-plane"></i><span> 留言板</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于我</span></a></div></div></div></div><div class="page" id="body-wrap"><header class="not-home-page" id="page-header" style="background-image: url(/img/%E4%B9%A1%E9%97%B4%E5%B0%8F%E8%B7%AF-%E4%BA%91%E6%9C%B5%E6%9C%88%E4%BA%AE.webp);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><img class="site-icon" src= "/img/20241215205335173426721579192.webp" data-lazy-src="/img/logo.png" alt="Logo"><span class="site-name">余一叶知秋尽</span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list-ul"></i><span> 归档</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类别</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签集</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-outdent"></i><span> AI</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/ai/aigc/"><i class="fa-fw fas fa-cubes"></i><span> AIGC 创意平台</span></a></li><li><a class="site-page child" href="/ai/agent/medical/"><i class="fa-fw fas fa-medkit"></i><span> 医疗问答Agent</span></a></li><li><a class="site-page child" href="https://github.com/HengLine/ai-stocks-agent"><i class="fa-fw fas fa-line-chart"></i><span> 股票分析Agent</span></a></li><li><a class="site-page child" href="/ai/agent/video/"><i class="fa-fw fas fa-cut"></i><span> 视频混剪Agent</span></a></li><li><a class="site-page child" href="https://github.com/HengLine/video-shot-agent"><i class="fa-fw fas fa-file-video"></i><span> 剧本分镜Agent</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list-ol"></i><span> 项目</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/turnkey/smart-city"><i class="fa-fw fas fa-building"></i><span> 智慧城市（IOT）</span></a></li><li><a class="site-page child" href="/turnkey/smart-security"><i class="fa-fw fas fa-check-circle"></i><span> 智慧安检（IOT）</span></a></li><li><a class="site-page child" href="/turnkey/tms"><i class="fa-fw fas fa-truck"></i><span> 物流运输（TMS）</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-cogs"></i><span> 工具</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/tools/json/"><i class="fa-fw fas fa-cog"></i><span> JSON 转换工具集</span></a></li><li><a class="site-page child" href="/tools/diagrams/mermaid"><i class="fa-fw fas fa-pie-chart"></i><span> 在线绘制 UML 图</span></a></li><li><a class="site-page child" href="/tools/image/compressor/"><i class="fa-fw fas fa-image"></i><span> 图像批量压缩大小</span></a></li><li><a class="site-page child" href="/tools/image/watermark/"><i class="fa-fw fas fa-image"></i><span> 图像批量添加水印</span></a></li><li><a class="site-page child" href="/tools/image/convert/"><i class="fa-fw fas fa-file-image"></i><span> 图像格式编码转换</span></a></li><li><a class="site-page child" href="/tools/video/cropping/"><i class="fa-fw fas fa-cut"></i><span> 视频时长范围裁剪</span></a></li><li><a class="site-page child" href="/tools/video/watermark/"><i class="fa-fw fas fa-video"></i><span> 视频加水印马赛克</span></a></li><li><a class="site-page child" href="/tools/download/"><i class="fa-fw fas fa-cloud-download"></i><span> 批量下载视频图片</span></a></li><li><a class="site-page child" href="/tools/docu/watermark/"><i class="fa-fw fas fa-file-pdf"></i><span> PDF 文档添加水印</span></a></li><li><a class="site-page child" href="/tools/docu/signature"><i class="fa-fw fas fa-file"></i><span> 文档在线手写签名</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-pencil-square"></i><span> 文学</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/literature/poems"><i class="fa-fw fas fa-align-center"></i><span> 三行诗集</span></a></li><li><a class="site-page child" href="/literature/classical"><i class="fa-fw fas fa-align-justify"></i><span> 诗词歌赋</span></a></li><li><a class="site-page child" href="/literature/modern"><i class="fa-fw fas fa-align-left"></i><span> 现代诗歌</span></a></li><li><a class="site-page child" href="/literature/journal"><i class="fa-fw fas fa-align-right"></i><span> 随心随笔</span></a></li><li><a class="site-page child" href="/literature/incomplete"><i class="fa-fw fas fa-columns"></i><span> 忘梦残句</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-commenting"></i><span> 交流</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></li><li><a class="site-page child" href="/messageboard/"><i class="fa-fw fas fa-paper-plane"></i><span> 留言板</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于我</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="page-site-info"><h1 id="site-title"></h1></div></header><main class="layout" id="content-inner"><div id="page"><div class="container" id="article-container"><!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>数字城管 - 智慧城市管理平台</title>
    <link rel="stylesheet" href="/css/hexo-common.css">
    <link rel="stylesheet" href="/css/hexo-full-screen.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        .container {
            font-family: 'Microsoft YaHei', sans-serif !important;
            background: #f5f7fa !important;
            color: #333 !important;
            line-height: 1.6 !important;
            max-width: 1400px !important;
            margin: 0 auto !important;
            padding: 20px !important;
        }

        .container header {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        h1 {
            font-size: 1.8em;
            color: #2c3e50;
        }

        .nav-btn {
            background: #667eea !important;
            color: white !important;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            text-decoration: none;
            font-size: 1em;
            transition: background 0.3s ease;
        }

        .nav-btn:hover {
            background: #5a6fd8;
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .metric-card {
            background: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            text-align: center;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .metric-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.15);
        }

        .metric-value {
            font-size: 2.5em;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .metric-label {
            font-size: 1em;
            color: #7f8c8d;
            margin-bottom: 10px;
        }

        .metric-trend {
            font-size: 0.9em;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
        }

        .trend-up {
            color: #27ae60;
        }

        .trend-down {
            color: #e74c3c;
        }

        .main-content {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        .map-section {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .map-placeholder {
            width: 100%;
            height: 400px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5em;
            margin-bottom: 20px;
        }

        .map-controls {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .control-btn {
            background: #ecf0f1;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            transition: background 0.3s ease;
        }

        .control-btn:hover, .control-btn.active {
            background: #667eea;
            color: white;
        }

        .alerts-section {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .alerts-section h3 {
            margin-bottom: 20px;
            color: #2c3e50;
            border-bottom: 2px solid #ecf0f1;
            padding-bottom: 10px;
        }

        .alert-item {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
            border-left: 4px solid #e74c3c;
            transition: background 0.3s ease;
        }

        .alert-item:hover {
            background: #e9ecef;
        }

        .alert-item.warning {
            border-left-color: #f39c12;
        }

        .alert-item.info {
            border-left-color: #3498db;
        }

        .alert-title {
            font-weight: bold;
            margin-bottom: 5px;
        }

        .alert-time {
            font-size: 0.8em;
            color: #7f8c8d;
        }

        .systems-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }

        .system-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .system-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.15);
        }

        .system-icon {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .system-name {
            font-weight: bold;
            margin-bottom: 5px;
            font-size: 1.1em;
        }

        .system-status {
            font-size: 0.9em;
            padding: 3px 10px;
            border-radius: 12px;
            display: inline-block;
            margin-bottom: 15px;
        }

        .system-stats {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid #ecf0f1;
        }

        .stat-item {
            font-size: 0.85em;
        }

        .stat-value {
            font-weight: bold;
            color: #2c3e50;
            display: block;
        }

        .stat-label {
            color: #7f8c8d;
        }

        .status-normal {
            background: #d4edda;
            color: #155724;
        }

        .status-warning {
            background: #fff3cd;
            color: #856404;
        }

        .status-alert {
            background: #f8d7da;
            color: #721c24;
        }

        .container footer {
            text-align: center;
            padding: 20px;
            color: #7f8c8d;
            margin-top: 30px;
        }



        /* 标签页导航样式 */
        .tabs-nav {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .tab-btn {
            background: #ecf0f1;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s ease;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        .tab-btn:hover {
            background: #d5dbdb;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
        }

        .tab-btn.active {
            background: #667eea;
            color: white;
            box-shadow: 0 4px 10px rgba(102, 126, 234, 0.4);
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.3s ease-in;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* 人员考核模块样式 */
        .personnel-section {
            display: grid;
            gap: 20px;
        }

        .personnel-metrics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }

        .personnel-ranking, .personnel-search {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .ranking-table table {
            width: 100%;
            border-collapse: collapse;
        }

        .ranking-table th, .ranking-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ecf0f1;
        }

        .ranking-table th {
            background: #f8f9fa;
            font-weight: bold;
            color: #2c3e50;
        }

        .ranking-table tr:hover {
            background: #f8f9fa;
        }

        /* 排名特殊样式 */
        .ranking-item.rank-first {
            background: linear-gradient(135deg, #fff176 0%, #ffeb3b 100%);
            font-weight: bold;
        }

        .ranking-item.rank-second {
            background: linear-gradient(135deg, #e0e0e0 0%, #bdbdbd 100%);
            font-weight: bold;
        }

        .ranking-item.rank-third {
            background: linear-gradient(135deg, #ffccbc 0%, #ffab91 100%);
            font-weight: bold;
        }

        .ranking-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }

        .ranking-item {
            cursor: pointer;
            transition: all 0.3s ease;
        }

        /* 模态框样式 */
        .personnel-detail-modal {
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* 搜索结果样式 */
        .search-result-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-top: 15px;
        }

        .search-result-item {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            border-left: 4px solid #667eea;
            transition: all 0.3s ease;
        }

        .search-result-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.15);
        }

        .search-result-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .search-result-header h5 {
            margin: 0;
            color: #2c3e50;
        }

        .employee-id {
            font-size: 0.8em;
            color: #667eea;
            font-weight: normal;
            margin-left: 10px;
        }

        .level-tag {
            padding: 3px 10px;
            border-radius: 12px;
            font-size: 0.8em;
            font-weight: bold;
        }

        .level-excellent {
            background: #d4edda;
            color: #155724;
        }

        .level-good {
            background: #d1ecf1;
            color: #0c5460;
        }

        .level-pass {
            background: #fff3cd;
            color: #856404;
        }

        .search-result-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
            margin-bottom: 15px;
        }

        .info-item {
            font-size: 0.9em;
            color: #555;
        }

        .search-result-actions {
            text-align: right;
        }

        .view-detail-btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9em;
            transition: background 0.3s ease;
        }

        .view-detail-btn:hover {
            background: #5a6fd8;
        }

        /* 高级筛选样式 */
        .advanced-filters {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid #ecf0f1;
        }

        /* 下拉选择框样式 */
        #department-filter {
            padding: 10px 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 1em;
            background: white;
            min-width: 150px;
            cursor: pointer;
            transition: border-color 0.3s ease;
        }

        #department-filter:hover {
            border-color: #667eea;
        }

        /* 维护管理模块样式 */
        .plan-item {
            background: #f9fafb;
            border-radius: 10px;
            margin-bottom: 15px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            border-left: 4px solid #667eea;
        }

        .plan-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.15);
        }

        .plan-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 20px;
            background: white;
            border-radius: 10px 10px 0 0;
        }

        .plan-header h5 {
            margin: 0;
            color: #2c3e50;
        }

        .plan-status {
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 0.85em;
            font-weight: bold;
        }

        .status-pending {
            background: #f39c12;
            color: white;
        }

        .status-scheduled {
            background: #27ae60;
            color: white;
        }

        .plan-content {
            padding: 15px 20px;
        }

        .plan-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 15px;
        }

        .info-item {
            display: flex;
            flex-direction: column;
        }

        .info-label {
            font-size: 0.8em;
            color: #666;
            margin-bottom: 3px;
        }

        .info-value {
            font-weight: 500;
            color: #2c3e50;
        }

        .info-item.full-width {
            grid-column: 1 / -1;
        }

        .plan-actions, .record-actions {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid #eee;
        }

        .action-btn {
            padding: 8px 16px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9em;
            transition: background 0.3s ease;
        }

        .execute-btn {
            background: #27ae60;
            color: white;
        }

        .execute-btn:hover {
            background: #219653;
        }

        .delay-btn {
            background: #f39c12;
            color: white;
        }

        .delay-btn:hover {
            background: #e67e22;
        }

        .cancel-btn {
            background: #e74c3c;
            color: white;
        }

        .cancel-btn:hover {
            background: #c0392b;
        }

        .view-detail-btn {
            background: #667eea;
            color: white;
        }

        .view-detail-btn:hover {
            background: #5a6fd8;
        }

        .print-btn {
            background: #95a5a6;
            color: white;
        }

        .print-btn:hover {
            background: #7f8c8d;
        }

        /* 维护记录样式 */
        .record-item {
            background: #f9fafb;
            border-radius: 10px;
            margin-bottom: 15px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            border-left: 4px solid #27ae60;
        }

        .record-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.15);
        }

        .record-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 20px;
            background: white;
            border-radius: 10px 10px 0 0;
        }

        .record-header h5 {
            margin: 0;
            color: #2c3e50;
        }

        .record-result {
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 0.85em;
            font-weight: bold;
        }

        .result-success {
            background: #27ae60;
            color: white;
        }

        .result-partial {
            background: #f39c12;
            color: white;
        }

        .result-failed {
            background: #e74c3c;
            color: white;
        }

        .record-content {
            padding: 15px 20px;
        }

        .record-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 15px;
        }

        /* 维护记录详情模态框样式 */
        .maintenance-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            animation: fadeIn 0.3s ease;
        }

        .record-detail-modal {
            background: white;
            border-radius: 10px;
            padding: 30px;
            max-width: 90%;
            max-height: 90%;
            overflow-y: auto;
            width: 800px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .record-detail-modal h4 {
            margin-top: 0;
            color: #2c3e50;
            border-bottom: 2px solid #ecf0f1;
            padding-bottom: 10px;
        }

        .detail-container {
            margin-top: 20px;
        }

        .detail-section {
            margin-bottom: 25px;
        }

        .detail-section h5 {
            margin-bottom: 15px;
            color: #34495e;
            font-size: 1.1em;
        }

        .detail-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            background: #f9fafb;
            padding: 20px;
            border-radius: 8px;
        }

        .result-tag {
            padding: 3px 8px;
            border-radius: 10px;
            font-size: 0.8em;
            font-weight: bold;
        }

        .detail-actions {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid #ecf0f1;
        }

        .search-controls {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        .search-controls input {
            flex: 1;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 1em;
        }

        .search-btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            transition: background 0.3s ease;
        }

        .search-btn:hover {
            background: #5a6fd8;
        }

        /* 维护管理模块样式 */
        .maintenance-section {
            display: grid;
            gap: 20px;
        }

        .maintenance-overview {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }

        .maintenance-plans, .maintenance-records {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .plan-list, .records-list {
            max-height: 400px;
            overflow-y: auto;
        }

        /* 事件处理模块样式 */
        .incident-section {
            display: grid;
            gap: 20px;
        }

        .incident-flow {
            display: flex;
            justify-content: space-around;
            align-items: center;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            flex-wrap: wrap;
            gap: 10px;
        }

        .flow-step {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 15px;
            border-radius: 10px;
            background: #f8f9fa;
            transition: all 0.3s ease;
            min-width: 120px;
        }

        .flow-step.active {
            background: #667eea;
            color: white;
            box-shadow: 0 4px 10px rgba(102, 126, 234, 0.4);
        }

        .flow-icon {
            font-size: 2em;
            margin-bottom: 10px;
        }

        .flow-name {
            font-weight: bold;
            margin-bottom: 5px;
        }

        .flow-count {
            font-size: 0.9em;
            opacity: 0.8;
        }

        .flow-arrow {
            font-size: 1.5em;
            color: #bdc3c7;
            margin: 0 5px;
        }

        .incident-list, .incident-detail {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .event-list {
            max-height: 400px;
            overflow-y: auto;
        }

        /* 事件汇总模块样式 */
        .summary-section {
            display: grid;
            gap: 20px;
        }

        .summary-metrics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }

        .summary-charts {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .summary-stats {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .stats-table table {
            width: 100%;
            border-collapse: collapse;
        }

        .stats-table th, .stats-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ecf0f1;
        }

        .stats-table th {
            background: #f8f9fa;
            font-weight: bold;
            color: #2c3e50;
        }

        /* 响应式设计 */
        @media (max-width: 1024px) {
            /* 决策分析模块响应式 */
            .decision-section {
                padding: 15px;
            }
            
            .flood-metrics {
                grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
                gap: 10px;
            }
        }

        @media (max-width: 768px) {
            /* 标签页导航响应式 */
            .tabs-nav {
                flex-direction: column;
                gap: 8px;
            }

            .tab-btn {
                width: 100%;
                padding: 10px 15px;
            }

            /* 事件流程响应式 */
            .incident-flow {
                flex-direction: column;
            }

            .flow-arrow {
                transform: rotate(90deg);
            }

            /* 主要内容布局响应式 */
            .main-content {
                grid-template-columns: 1fr;
            }

            /* 指标卡片响应式 */
            .dashboard-grid,
            .personnel-metrics,
            .maintenance-overview,
            .summary-metrics {
                grid-template-columns: repeat(2, 1fr);
            }

            /* 决策分析模块响应式 */
            .decision-section {
                padding: 15px;
            }
            
            .flood-metrics {
                grid-template-columns: 1fr;
            }

            /* 表格响应式 */
            .ranking-table,
            .stats-table {
                overflow-x: auto;
            }

            table {
                width: 100%;
                min-width: 600px;
            }

            /* 地图控制按钮响应式 */
            .map-controls {
                flex-wrap: wrap;
                justify-content: center;
            }

            .control-btn {
                flex: 1;
                min-width: 100px;
            }
        }

        @media (max-width: 480px) {
            /* 指标卡片响应式 */
            .dashboard-grid,
            .personnel-metrics,
            .maintenance-overview,
            .summary-metrics {
                grid-template-columns: 1fr;
            }

            /* 系统卡片响应式 */
            .systems-grid {
                grid-template-columns: 1fr;
            }

            /* 标题响应式 */
            h1 {
                font-size: 1.5em;
            }

            h2, h3, h4 {
                font-size: 1.2em;
            }

            /* 地图控制按钮响应式 */
            .control-btn {
                width: 100%;
            }

            /* 决策分析模块响应式 */
            .decision-section {
                margin-bottom: 15px;
                padding: 10px;
            }

            .flood-control {
                padding: 15px 10px;
            }

            /* 图表响应式 */
            .chart {
                height: 200px !important;
            }
        }

        /* 图表样式 */
        .charts-section {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            margin: 30px 0;
        }

        .chart-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .chart-box {
            border: 1px solid #ecf0f1;
            border-radius: 8px;
            padding: 20px;
            background: #fafafa;
        }

        .chart-title {
            font-size: 1em;
            font-weight: bold;
            margin-bottom: 15px;
            color: #2c3e50;
            text-align: center;
        }

        .chart {
            width: 100%;
            height: 350px; /* 设置固定高度确保图表正确显示 */
            position: relative;
            margin: 0 auto;
        }
        
        /* 为SVG元素设置明确的尺寸 */
        .chart svg {
            width: 100% !important;
            height: 100% !important;
            display: block !important;
            min-height: 350px !important;
        }

        .charts-section h3 {
            margin-bottom: 20px;
            color: #2c3e50;
        }

        .chart-line {
            fill: none;
            stroke: #667eea;
            stroke-width: 2px;
        }

        .chart-area {
            fill: rgba(102, 126, 234, 0.1);
            stroke: none;
        }

        .chart-axis {
            stroke: #bdc3c7;
            stroke-width: 1px;
        }

        .chart-grid {
            stroke: #ecf0f1;
            stroke-width: 1px;
            stroke-dasharray: 2, 2;
        }

        .chart-label {
            font-size: 0.7em;
            fill: #7f8c8d;
            text-anchor: middle;
        }

        /* 监控点列表样式 */
        .monitor-list {
            margin-top: 20px;
            border-top: 1px solid #ecf0f1;
            padding-top: 20px;
        }

        .monitor-list h4 {
            margin-bottom: 15px;
            color: #2c3e50;
            font-size: 1em;
        }

        #monitor-list-content {
            max-height: 500px;
            overflow-y: auto;
            background: #f9fafb;
            border-radius: 8px;
            padding: 15px;
        }

        .monitor-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 15px;
            margin-bottom: 8px;
            background: white;
            border-radius: 6px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            border-left: 3px solid #667eea;
        }

        .monitor-item:hover {
            transform: translateX(5px);
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.15);
        }

        .monitor-item.traffic {
            border-left-color: #e74c3c;
        }

        .monitor-item.environment {
            border-left-color: #27ae60;
        }

        .monitor-item.municipal {
            border-left-color: #f39c12;
        }

        .monitor-item.drainage {
            border-left-color: #3498db;
        }

        .monitor-item.lighting {
            border-left-color: #f1c40f;
        }

        .monitor-item.parking {
            border-left-color: #e67e22;
        }

        .monitor-info {
            display: flex;
            flex-direction: column;
        }

        .monitor-name {
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 3px;
        }

        .monitor-status {
            font-size: 0.8em;
            color: #7f8c8d;
        }

        .monitor-position {
            font-size: 0.8em;
            color: #667eea;
        }

        .status-normal {
            color: #27ae60;
        }

        .status-alert {
            color: #e74c3c;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div>
                <h1>🏙️ 数字城管</h1>
                <p>城市运行状态实时监控与管理</p>
            </div>
            <a href="index.html" class="nav-btn">🔙 返回主页面</a>
        </header>

        <!-- 标签页导航 -->
        <div class="tabs-nav">
            <button class="tab-btn active" data-tab="overview">📊 综合概览</button>
            <button class="tab-btn" data-tab="personnel">👥 人员考核</button>
            <button class="tab-btn" data-tab="maintenance">🔧 维护管理</button>
            <button class="tab-btn" data-tab="incident">📋 综合执法</button>
            <button class="tab-btn" data-tab="decision">🎯 决策分析</button>
            <button class="tab-btn" data-tab="summary">📈 事件汇总</button>
            <button class="tab-btn" data-tab="public-service">🏛️ 公共服务</button>
        </div>

        <!-- 综合概览标签页 -->
        <div class="tab-content active" id="overview">
            <div class="dashboard-grid">
                <div class="metric-card" data-metric="system-uptime">
                    <div class="metric-value" style="color: #3498db;">98.2%</div>
                    <div class="metric-label">系统运行率</div>
                    <div class="metric-trend trend-up">
                        <span>↑</span>
                        <span>0.5%</span>
                    </div>
                </div>
                <div class="metric-card" data-metric="monitor-points">
                    <div class="metric-value" style="color: #27ae60;">1,234</div>
                    <div class="metric-label">实时监控点</div>
                    <div class="metric-trend trend-up">
                        <span>↑</span>
                        <span>23</span>
                    </div>
                </div>
                <div class="metric-card" data-metric="current-alerts">
                    <div class="metric-value" style="color: #e74c3c;">8</div>
                    <div class="metric-label">当前预警数</div>
                    <div class="metric-trend trend-down">
                        <span>↓</span>
                        <span>3</span>
                    </div>
                </div>
                <div class="metric-card" data-metric="problem-solve-rate">
                    <div class="metric-value" style="color: #f39c12;">92.5%</div>
                    <div class="metric-label">问题解决率</div>
                    <div class="metric-trend trend-up">
                        <span>↑</span>
                        <span>1.2%</span>
                    </div>
                </div>
                <div class="metric-card" data-metric="today-tickets">
                    <div class="metric-value" style="color: #9b59b6;">56</div>
                    <div class="metric-label">今日工单</div>
                    <div class="metric-trend trend-up">
                        <span>↑</span>
                        <span>8</span>
                    </div>
                </div>
                <div class="metric-card" data-metric="online-devices">
                    <div class="metric-value" style="color: #1abc9c;">4,567</div>
                    <div class="metric-label">设备在线数</div>
                    <div class="metric-trend trend-up">
                        <span>↑</span>
                        <span>123</span>
                    </div>
                </div>
                <div class="metric-card" data-metric="offline-devices">
                    <div class="metric-value" style="color: #95a5a6;">45</div>
                    <div class="metric-label">离线设备数</div>
                    <div class="metric-trend trend-down">
                        <span>↓</span>
                        <span>5</span>
                    </div>
                </div>
                <div class="metric-card" data-metric="pending-tickets">
                    <div class="metric-value" style="color: #f39c12;">28</div>
                    <div class="metric-label">待处理工单</div>
                    <div class="metric-trend trend-up">
                        <span>↑</span>
                        <span>3</span>
                    </div>
                </div>
                <div class="metric-card" data-metric="abnormal-devices">
                    <div class="metric-value" style="color: #e74c3c;">12</div>
                    <div class="metric-label">异常设备数</div>
                    <div class="metric-trend trend-up">
                        <span>↑</span>
                        <span>2</span>
                    </div>
                </div>
            </div>

            <div class="main-content">
                <div class="map-section">
                    <h3>城市地图监控</h3>
                    <div class="map-placeholder" style="position: relative; overflow: hidden;">
                        <div class="city-map" style="width: 100%; height: 100%; position: relative; background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);">
                            <!-- 城市道路网格 -->
                            <div class="road horizontal" style="position: absolute; top: 25%; left: 0; right: 0; height: 2px; background: rgba(100, 100, 100, 0.3);"></div>
                            <div class="road horizontal" style="position: absolute; top: 50%; left: 0; right: 0; height: 2px; background: rgba(100, 100, 100, 0.3);"></div>
                            <div class="road horizontal" style="position: absolute; top: 75%; left: 0; right: 0; height: 2px; background: rgba(100, 100, 100, 0.3);"></div>
                            <div class="road vertical" style="position: absolute; left: 25%; top: 0; bottom: 0; width: 2px; background: rgba(100, 100, 100, 0.3);"></div>
                            <div class="road vertical" style="position: absolute; left: 50%; top: 0; bottom: 0; width: 2px; background: rgba(100, 100, 100, 0.3);"></div>
                            <div class="road vertical" style="position: absolute; left: 75%; top: 0; bottom: 0; width: 2px; background: rgba(100, 100, 100, 0.3);"></div>
                            
                            <!-- 交通监控点 -->
                            <div class="monitor-point traffic" data-type="交通监控" style="position: absolute; top: 25%; left: 15%; width: 12px; height: 12px; background: #e74c3c; border-radius: 50%; box-shadow: 0 0 10px #e74c3c; animation: pulse 2s infinite;"></div>
                            <div class="monitor-point traffic" data-type="交通监控" style="position: absolute; top: 50%; left: 30%; width: 12px; height: 12px; background: #3498db; border-radius: 50%; box-shadow: 0 0 10px #3498db;"></div>
                            <div class="monitor-point traffic" data-type="交通监控" style="position: absolute; top: 75%; left: 45%; width: 12px; height: 12px; background: #3498db; border-radius: 50%; box-shadow: 0 0 10px #3498db;"></div>
                            
                            <!-- 环卫设施监控点 -->
                            <div class="monitor-point environment" data-type="环卫设施" style="position: absolute; top: 30%; left: 25%; width: 10px; height: 10px; background: #27ae60; border-radius: 50%; box-shadow: 0 0 8px #27ae60;"></div>
                            <div class="monitor-point environment" data-type="环卫设施" style="position: absolute; top: 60%; left: 60%; width: 10px; height: 10px; background: #e74c3c; border-radius: 50%; box-shadow: 0 0 8px #e74c3c; animation: pulse 2s infinite;"></div>
                            
                            <!-- 市政设施监控点 -->
                            <div class="monitor-point municipal" data-type="市政设施" style="position: absolute; top: 20%; left: 60%; width: 8px; height: 8px; background: #f39c12; border-radius: 50%; box-shadow: 0 0 6px #f39c12;"></div>
                            <div class="monitor-point municipal" data-type="市政设施" style="position: absolute; top: 80%; left: 20%; width: 8px; height: 8px; background: #9b59b6; border-radius: 50%; box-shadow: 0 0 6px #9b59b6;"></div>
                            
                            <!-- 排水系统监控点 -->
                            <div class="monitor-point drainage" data-type="排水系统" style="position: absolute; top: 40%; left: 70%; width: 10px; height: 10px; background: #3498db; border-radius: 50%; box-shadow: 0 0 8px #3498db;"></div>
                            <div class="monitor-point drainage" data-type="排水系统" style="position: absolute; top: 60%; left: 15%; width: 10px; height: 10px; background: #e74c3c; border-radius: 50%; box-shadow: 0 0 8px #e74c3c; animation: pulse 2s infinite;"></div>
                            
                            <!-- 照明系统监控点 -->
                            <div class="monitor-point lighting" data-type="照明系统" style="position: absolute; top: 30%; left: 40%; width: 8px; height: 8px; background: #f1c40f; border-radius: 50%; box-shadow: 0 0 6px #f1c40f;"></div>
                            <div class="monitor-point lighting" data-type="照明系统" style="position: absolute; top: 70%; left: 50%; width: 8px; height: 8px; background: #f1c40f; border-radius: 50%; box-shadow: 0 0 6px #f1c40f;"></div>
                            
                            <!-- 停车场监控点 -->
                            <div class="monitor-point parking" data-type="停车场" style="position: absolute; top: 50%; left: 80%; width: 12px; height: 12px; background: #e67e22; border-radius: 50%; box-shadow: 0 0 10px #e67e22;"></div>
                            <div class="monitor-point parking" data-type="停车场" style="position: absolute; top: 20%; left: 35%; width: 12px; height: 12px; background: #e74c3c; border-radius: 50%; box-shadow: 0 0 10px #e74c3c; animation: pulse 2s infinite;"></div>
                            
                            <!-- 事件标记 -->
                            <div class="incident-marker" data-type="交通拥堵" style="position: absolute; top: 45%; left: 25%; width: 20px; height: 20px; background: #e74c3c; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-size: 12px; animation: pulse 1.5s infinite;">🚨</div>
                            <div class="incident-marker" data-type="垃圾满溢" style="position: absolute; top: 55%; left: 65%; width: 20px; height: 20px; background: #f39c12; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-size: 12px; animation: pulse 1.5s infinite 0.5s;">�️</div>
                        </div>
                        <style>
                            @keyframes pulse {
                                0% { transform: scale(1); opacity: 1; }
                                50% { transform: scale(1.5); opacity: 0.7; }
                                100% { transform: scale(1); opacity: 1; }
                            }
                        </style>
                    </div>
                    <div class="map-controls">
                        <button class="control-btn active">全部显示</button>
                        <button class="control-btn">交通监控</button>
                        <button class="control-btn">环卫设施</button>
                        <button class="control-btn">市政设施</button>
                        <button class="control-btn">排水系统</button>
                        <button class="control-btn">照明系统</button>
                        <button class="control-btn">停车场</button>
                    </div>
                    
                    <!-- 监控点列表 -->
                    <div class="monitor-list">
                        <h4>监控点列表</h4>
                        <div id="monitor-list-content">
                            <p>点击上方按钮查看对应类型的监控点列表</p>
                        </div>
                    </div>
                </div>

                <div class="alerts-section">
                    <h3>⚠️ 实时预警信息</h3>
                    <div id="alerts-container">
                        <div class="alert-item">
                            <div class="alert-title">XX大道与XX路交叉口交通拥堵</div>
                            <div>拥堵指数：85%，预计持续时间：30分钟</div>
                            <div class="alert-time">2026-01-16 14:30:25</div>
                        </div>
                        <div class="alert-item warning">
                            <div class="alert-title">XX公园北门垃圾桶满溢</div>
                            <div>位置：XX街道35号，已满程度：90%</div>
                            <div class="alert-time">2026-01-16 14:25:10</div>
                        </div>
                        <div class="alert-item info">
                            <div class="alert-title">照明系统维护提醒</div>
                            <div>XX路10盏路灯需要维护检查</div>
                            <div class="alert-time">2026-01-16 14:20:05</div>
                        </div>
                        <div class="alert-item">
                            <div class="alert-title">XX小区排水口流量异常</div>
                            <div>当前流量：120%，超过警戒值</div>
                            <div class="alert-time">2026-01-16 14:15:30</div>
                        </div>
                        <div class="alert-item warning">
                            <div class="alert-title">XX停车场车位紧张</div>
                            <div>当前剩余车位：5/100，建议引导至附近停车场</div>
                            <div class="alert-time">2026-01-16 14:10:45</div>
                        </div>
                        <div class="alert-item info">
                            <div class="alert-title">市政设施巡检提醒</div>
                            <div>XX广场公共设施需要定期巡检</div>
                            <div class="alert-time">2026-01-16 14:05:20</div>
                        </div>
                        <div class="alert-item">
                            <div class="alert-title">XX路段井盖异常</div>
                            <div>位置：XX大道288号，检测到异常位移</div>
                            <div class="alert-time">2026-01-16 14:00:15</div>
                        </div>
                        <div class="alert-item warning">
                            <div class="alert-title">XX区域环境监测异常</div>
                            <div>PM2.5浓度：75μg/m³，接近警戒值</div>
                            <div class="alert-time">2026-01-16 13:55:30</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="charts-section">
                <h3>📊 今日运行趋势</h3>
                <div class="chart-container">
                    <div class="chart-box">
                        <div class="chart-title">今日工单趋势</div>
                        <div class="chart">
                            <svg id="tickets-chart" width="100%" height="100%"></svg>
                        </div>
                    </div>
                    <div class="chart-box">
                        <div class="chart-title">设备在线率趋势</div>
                        <div class="chart">
                            <svg id="devices-chart" width="100%" height="100%"></svg>
                        </div>
                    </div>
                </div>
            </div>

            <h3 style="margin: 30px 0 20px;">🔧 子系统运行状态</h3>
            <div class="systems-grid">
                <div class="system-card" data-system="smart-street">
                    <div class="system-icon">🚦</div>
                    <div class="system-name">智慧街面</div>
                    <div class="system-status status-normal">正常运行</div>
                    <div class="system-stats">
                        <div class="stat-item">
                            <span class="stat-value">234</span>
                            <span class="stat-label">在线设备</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-value">15</span>
                            <span class="stat-label">今日工单</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-value">98.5%</span>
                            <span class="stat-label">运行率</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-value">12s</span>
                            <span class="stat-label">响应时间</span>
                        </div>
                    </div>
                </div>
                <div class="system-card" data-system="smart-environment">
                    <div class="system-icon">🗑️</div>
                    <div class="system-name">智慧环卫</div>
                    <div class="system-status status-warning">需关注</div>
                    <div class="system-stats">
                        <div class="stat-item">
                            <span class="stat-value">156</span>
                            <span class="stat-label">垃圾桶数</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-value">28</span>
                            <span class="stat-label">满溢预警</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-value">94.2%</span>
                            <span class="stat-label">运行率</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-value">8h</span>
                            <span class="stat-label">清理周期</span>
                        </div>
                    </div>
                </div>
                <div class="system-card" data-system="smart-municipal">
                    <div class="system-icon">🏗️</div>
                    <div class="system-name">智慧市政</div>
                    <div class="system-status status-normal">正常运行</div>
                    <div class="system-stats">
                        <div class="stat-item">
                            <span class="stat-value">567</span>
                            <span class="stat-label">设施总数</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-value">32</span>
                            <span class="stat-label">维护工单</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-value">97.8%</span>
                            <span class="stat-label">完好率</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-value">48h</span>
                            <span class="stat-label">维修响应</span>
                        </div>
                    </div>
                </div>
                <div class="system-card" data-system="smart-drainage">
                    <div class="system-icon">💧</div>
                    <div class="system-name">智慧排水</div>
                    <div class="system-status status-alert">预警</div>
                    <div class="system-stats">
                        <div class="stat-item">
                            <span class="stat-value">89</span>
                            <span class="stat-label">监测点</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-value">5</span>
                            <span class="stat-label">异常点</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-value">92.1%</span>
                            <span class="stat-label">运行率</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-value">1.2m</span>
                            <span class="stat-label">平均液位</span>
                        </div>
                    </div>
                </div>
                <div class="system-card" data-system="smart-lighting">
                    <div class="system-icon">💡</div>
                    <div class="system-name">智慧照明</div>
                    <div class="system-status status-normal">正常运行</div>
                    <div class="system-stats">
                        <div class="stat-item">
                            <span class="stat-value">1,234</span>
                            <span class="stat-label">路灯总数</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-value">18</span>
                            <span class="stat-label">故障灯</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-value">98.5%</span>
                            <span class="stat-label">完好率</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-value">3h</span>
                            <span class="stat-label">维修响应</span>
                        </div>
                    </div>
                </div>
                <div class="system-card" data-system="smart-parking">
                    <div class="system-icon">🅿️</div>
                    <div class="system-name">智慧停车</div>
                    <div class="system-status status-normal">正常运行</div>
                    <div class="system-stats">
                        <div class="stat-item">
                            <span class="stat-value">5,678</span>
                            <span class="stat-label">总车位</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-value">3,456</span>
                            <span class="stat-label">已占用</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-value">99.2%</span>
                            <span class="stat-label">运行率</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-value">65%</span>
                            <span class="stat-label">使用率</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 人员考核标签页 -->
        <div class="tab-content" id="personnel">
            <h3 style="margin: 20px 0;">👥 人员考核管理</h3>
            <div class="personnel-section">
                <!-- 考核指标概览 -->
                <div class="personnel-metrics">
                    <div class="metric-card">
                        <div class="metric-value" style="color: #27ae60;">89.5%</div>
                        <div class="metric-label">平均考核得分</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" style="color: #3498db;">120</div>
                        <div class="metric-label">考核人员总数</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" style="color: #f39c12;">92%</div>
                        <div class="metric-label">任务完成率</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" style="color: #e74c3c;">15</div>
                        <div class="metric-label">待考核人员</div>
                    </div>
                </div>

                <!-- 考核排名 -->
                <div class="personnel-ranking">
                    <h4>考核排名</h4>
                    <div class="ranking-table">
                        <table>
                            <thead>
                                <tr>
                                    <th>排名</th>
                                    <th>姓名</th>
                                    <th>部门</th>
                                    <th>考核得分</th>
                                    <th>任务完成数</th>
                                    <th>服务满意度</th>
                                </tr>
                            </thead>
                            <tbody id="ranking-body">
                                <!-- 动态生成排名数据 -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- 考核详情搜索 -->
                <div class="personnel-search">
                    <h4>考核详情查询</h4>
                    <div class="search-controls">
                        <input type="text" placeholder="输入姓名或工号" id="personnel-search-input">
                        <select id="department-filter" placeholder="选择部门">
                            <option value="">所有部门</option>
                            <option value="交通管理">交通管理</option>
                            <option value="环卫清洁">环卫清洁</option>
                            <option value="市政维护">市政维护</option>
                            <option value="排水管理">排水管理</option>
                            <option value="照明管理">照明管理</option>
                            <option value="停车场管理">停车场管理</option>
                        </select>
                        <button class="search-btn">查询</button>
                    </div>
                    
                    <!-- 高级筛选 -->
                    <div class="advanced-filters">
                        <h5 style="margin: 15px 0 10px;">高级筛选</h5>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                            <div>
                                <label style="display: block; margin-bottom: 5px;">分数范围：<span id="score-range-text">80-100</span></label>
                                <input type="range" id="score-range" min="0" max="100" value="80,100" step="5" style="width: 100%;">
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 5px;">任务完成数：<span id="tasks-range-text">0-100</span></label>
                                <input type="range" id="tasks-range" min="0" max="100" value="0,100" step="10" style="width: 100%;">
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 5px;">满意度：<span id="satisfaction-range-text">0-100%</span></label>
                                <input type="range" id="satisfaction-range" min="0" max="100" value="0,100" step="10" style="width: 100%;">
                            </div>
                        </div>
                    </div>
                    
                    <div class="search-result" id="personnel-search-result">
                        <!-- 查询结果 -->
                    </div>
                </div>
            </div>
        </div>

        <!-- 维护管理标签页 -->
        <div class="tab-content" id="maintenance">
            <h3 style="margin: 20px 0;">🔧 维护管理</h3>
            <div class="maintenance-section">
                <!-- 维护概览 -->
                <div class="maintenance-overview">
                    <div class="metric-card">
                        <div class="metric-value" style="color: #e74c3c;">28</div>
                        <div class="metric-label">待维护设备</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" style="color: #27ae60;">156</div>
                        <div class="metric-label">本月已维护</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" style="color: #3498db;">98.2%</div>
                        <div class="metric-label">维护完成率</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" style="color: #f39c12;">4.5h</div>
                        <div class="metric-label">平均维护时长</div>
                    </div>
                </div>

                <!-- 维护计划 -->
                <div class="maintenance-plans">
                    <h4>维护计划</h4>
                    <div class="plan-list" id="maintenance-plans-list">
                        <!-- 动态生成维护计划 -->
                    </div>
                </div>

                <!-- 维护记录 -->
                <div class="maintenance-records">
                    <h4>维护记录</h4>
                    <div class="records-list" id="maintenance-records-list">
                        <!-- 动态生成维护记录 -->
                    </div>
                </div>
            </div>
        </div>

        <!-- 事件处理标签页 -->
        <div class="tab-content" id="incident">
            <h3 style="margin: 20px 0;">📋 事件处理流程</h3>
            <div class="incident-section">
                <!-- 事件流程概览 -->
                <div class="incident-flow">
                    <div class="flow-step active">
                        <div class="step-icon">📤</div>
                        <div class="step-name">事件上报</div>
                        <div class="step-count">12</div>
                    </div>
                    <div class="flow-arrow">→</div>
                    <div class="flow-step">
                        <div class="step-icon">📨</div>
                        <div class="step-name">事件派遣</div>
                        <div class="step-count">8</div>
                    </div>
                    <div class="flow-arrow">→</div>
                    <div class="flow-step">
                        <div class="step-icon">🔍</div>
                        <div class="step-name">事件核查</div>
                        <div class="step-count">5</div>
                    </div>
                    <div class="flow-arrow">→</div>
                    <div class="flow-step">
                        <div class="step-icon">⚠️</div>
                        <div class="step-name">忽略/处置</div>
                        <div class="step-count">3</div>
                    </div>
                    <div class="flow-arrow">→</div>
                    <div class="flow-step">
                        <div class="step-icon">✅</div>
                        <div class="step-name">结案/转案件</div>
                        <div class="step-count">20</div>
                    </div>
                </div>

                <!-- 待处理事件 -->
                <div class="incident-list">
                    <h4>待处理事件</h4>
                    <div class="event-list" id="pending-incidents">
                        <!-- 动态生成待处理事件 -->
                    </div>
                </div>

                <!-- 事件详情 -->
                <div class="incident-detail">
                    <h4>事件详情</h4>
                    <div class="detail-content" id="incident-detail-content">
                        <p>请选择一个事件查看详情</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- 决策分析标签页 -->
        <div class="tab-content" id="decision">
            <h3 style="margin: 20px 0;">🎯 决策分析</h3>
            
            <!-- 智慧排水模块 -->
            <div class="decision-section" style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1); margin-bottom: 20px;">
                <h4 style="margin-bottom: 20px; color: #2c3e50;">💧 智慧排水</h4>
                <div class="drainage-section">
                    <!-- 防汛防洪监控 -->
                    <div class="flood-control" style="margin-bottom: 20px; padding: 20px; background: #f9fafb; border-radius: 8px; border-left: 3px solid #3498db;">
                        <h5 style="margin-top: 0; margin-bottom: 15px;">⚠️ 防汛防洪预警系统</h5>
                        <div class="flood-metrics" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 20px;">
                            <div class="metric-card" style="background: white; padding: 15px; border-radius: 8px; box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);">
                                <div class="metric-value" style="color: #3498db; font-size: 1.8em;">75%</div>
                                <div class="metric-label" style="color: #7f8c8d;">当前水位</div>
                                <div class="metric-status" style="margin-top: 10px; padding: 5px 10px; border-radius: 12px; font-size: 0.8em; background: #f39c12; color: white;">预警阈值: 85%</div>
                            </div>
                            <div class="metric-card" style="background: white; padding: 15px; border-radius: 8px; box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);">
                                <div class="metric-value" style="color: #27ae60; font-size: 1.8em;">1,234</div>
                                <div class="metric-label" style="color: #7f8c8d;">监测点数量</div>
                                <div class="metric-status" style="margin-top: 10px; padding: 5px 10px; border-radius: 12px; font-size: 0.8em; background: #27ae60; color: white;">正常运行</div>
                            </div>
                            <div class="metric-card" style="background: white; padding: 15px; border-radius: 8px; box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);">
                                <div class="metric-value" style="color: #e74c3c; font-size: 1.8em;">0</div>
                                <div class="metric-label" style="color: #7f8c8d;">当前预警数</div>
                                <div class="metric-status" style="margin-top: 10px; padding: 5px 10px; border-radius: 12px; font-size: 0.8em; background: #27ae60; color: white;">无预警</div>
                            </div>
                        </div>
                        <div class="flood-alert" style="margin-top: 20px; padding: 15px; background: #fff3cd; border: 1px solid #ffeaa7; border-radius: 8px;">
                            <strong>预警设置：</strong>当水位超过85%时，自动发送预警短信给相关负责人
                        </div>
                    </div>
                </div>
            </div>

            <!-- 智慧照明模块 -->
            <div class="decision-section" style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1); margin-bottom: 20px;">
                <h4 style="margin-bottom: 20px; color: #2c3e50;">💡 智慧照明</h4>
                <div class="lighting-section">
                    <!-- 区域统计图表 -->
                    <div class="lighting-stats" style="margin-bottom: 20px;">
                        <h5 style="margin-top: 0; margin-bottom: 15px;">区域照明统计</h5>
                        <div class="chart" style="width: 100%; height: 300px;">
                            <svg id="lighting-region-chart" width="100%" height="100%"></svg>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 智慧停车模块 -->
            <div class="decision-section" style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1); margin-bottom: 20px;">
                <h4 style="margin-bottom: 20px; color: #2c3e50;">🅿️ 智慧停车</h4>
                <div class="parking-section">
                    <!-- 区域统计图表 -->
                    <div class="parking-stats" style="margin-bottom: 20px;">
                        <h5 style="margin-top: 0; margin-bottom: 15px;">区域停车统计</h5>
                        <div class="chart" style="width: 100%; height: 300px;">
                            <svg id="parking-region-chart" width="100%" height="100%"></svg>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 智慧环卫模块 -->
            <div class="decision-section" style="background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1); margin-bottom: 20px;">
                <h4 style="margin-bottom: 20px; color: #2c3e50;">♻️ 智慧环卫</h4>
                <div class="environment-section">
                    <!-- 综合统计图表 -->
                    <div class="environment-stats" style="margin-bottom: 20px;">
                        <h5 style="margin-top: 0; margin-bottom: 15px;">环卫设施综合统计</h5>
                        <div class="chart" style="width: 100%; height: 300px;">
                            <svg id="environment-comprehensive-chart" width="100%" height="100%"></svg>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 事件汇总标签页 -->
        <div class="tab-content" id="summary">
            <h3 style="margin: 20px 0;">📈 事件汇总分析</h3>
            <div class="summary-section">
                <!-- 汇总概览 -->
                <div class="summary-metrics">
                    <div class="metric-card">
                        <div class="metric-value" style="color: #27ae60;">456</div>
                        <div class="metric-label">本月总事件数</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" style="color: #3498db;">92.5%</div>
                        <div class="metric-label">事件解决率</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" style="color: #f39c12;">1.5h</div>
                        <div class="metric-label">平均处理时长</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" style="color: #e74c3c;">32</div>
                        <div class="metric-label">未解决事件</div>
                    </div>
                    <!-- 新增指标 -->
                    <div class="metric-card">
                        <div class="metric-value" style="color: #9b59b6;">12</div>
                        <div class="metric-label">事件类型</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" style="color: #1abc9c;">5</div>
                        <div class="metric-label">覆盖区域</div>
                    </div>
                </div>

                <!-- 事件类型分布 -->
                <div class="summary-charts">
                    <div class="chart-box">
                        <div class="chart-title">事件类型分布</div>
                        <div class="chart">
                            <svg id="incident-type-chart" width="100%" height="100%"></svg>
                        </div>
                    </div>
                    <div class="chart-box">
                        <div class="chart-title">事件处理趋势</div>
                        <div class="chart">
                            <svg id="incident-trend-chart" width="100%" height="100%"></svg>
                        </div>
                    </div>
                </div>

                <!-- 新增：部门与区域分布图表 -->
                <div class="summary-charts">
                    <div class="chart-box">
                        <div class="chart-title">部门处理分布</div>
                        <div class="chart">
                            <svg id="department-distribution-chart" width="100%" height="100%"></svg>
                        </div>
                    </div>
                    <div class="chart-box">
                        <div class="chart-title">区域事件分布</div>
                        <div class="chart">
                            <svg id="region-distribution-chart" width="100%" height="100%"></svg>
                        </div>
                    </div>
                </div>

                <!-- 事件处理统计 -->
                <div class="summary-stats">
                    <h4>事件处理统计</h4>
                    <div class="stats-table">
                        <table>
                            <thead>
                                <tr>
                                    <th>事件类型</th>
                                    <th>总数量</th>
                                    <th>解决数量</th>
                                    <th>解决率</th>
                                    <th>平均处理时长</th>
                                    <th>责任部门</th>
                                </tr>
                            </thead>
                            <tbody id="summary-stats-body">
                                <!-- 动态生成统计数据 -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- 新增：优先级分布统计 -->
                <div class="summary-stats">
                    <h4>事件优先级分布</h4>
                    <div class="stats-table">
                        <table>
                            <thead>
                                <tr>
                                    <th>事件类型</th>
                                    <th>高优先级</th>
                                    <th>中优先级</th>
                                    <th>低优先级</th>
                                    <th>责任区域</th>
                                </tr>
                            </thead>
                            <tbody id="priority-distribution-body">
                                <!-- 动态生成优先级分布数据 -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- 公共服务标签页 -->
        <div class="tab-content" id="public-service">
            <h3 style="margin: 20px 0;">🏛️ 公共服务管理</h3>
            <div class="public-service-section">
                <!-- 公共服务概览指标 -->
                <div class="summary-metrics">
                    <div class="metric-card">
                        <div class="metric-value" style="color: #27ae60;">12</div>
                        <div class="metric-label">服务类型</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" style="color: #3498db;">256</div>
                        <div class="metric-label">服务网点</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" style="color: #f39c12;">15</div>
                        <div class="metric-label">日均访问</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value" style="color: #e74c3c;">96.5%</div>
                        <div class="metric-label">用户满意度</div>
                    </div>
                </div>

                <!-- 公共服务子模块网格 -->
                <div class="systems-grid" style="margin-top: 30px;">
                    <!-- 办事网点、指南 -->
                    <div class="system-card" data-service="service-points">
                        <div class="system-icon">🏪</div>
                        <div class="system-name">办事网点、指南</div>
                        <div class="system-status status-normal">正常运行</div>
                        <div class="system-stats">
                            <div class="stat-item">
                                <span class="stat-value">89</span>
                                <span class="stat-label">办事网点</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-value">123</span>
                                <span class="stat-label">办事指南</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-value">APP</span>
                                <span class="stat-label">支持手机</span>
                            </div>
                        </div>
                    </div>

                    <!-- 自行车租赁站点 -->
                    <div class="system-card" data-service="bicycle-stations">
                        <div class="system-icon">🚲</div>
                        <div class="system-name">自行车租赁站点</div>
                        <div class="system-status status-normal">正常运行</div>
                        <div class="system-stats">
                            <div class="stat-item">
                                <span class="stat-value">45</span>
                                <span class="stat-label">租赁站点</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-value">890</span>
                                <span class="stat-label">自行车数</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-value">APP</span>
                                <span class="stat-label">支持手机</span>
                            </div>
                        </div>
                    </div>

                    <!-- 用户积分 -->
                    <div class="system-card" data-service="user-points">
                        <div class="system-icon">🎁</div>
                        <div class="system-name">用户积分</div>
                        <div class="system-status status-normal">正常运行</div>
                        <div class="system-stats">
                            <div class="stat-item">
                                <span class="stat-value">5,678</span>
                                <span class="stat-label">积分用户</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-value">12</span>
                                <span class="stat-label">兑换奖品</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-value">APP</span>
                                <span class="stat-label">支持手机</span>
                            </div>
                        </div>
                    </div>

                    <!-- 用户爆料 -->
                    <div class="system-card" data-service="user-reports">
                        <div class="system-icon">📣</div>
                        <div class="system-name">用户爆料</div>
                        <div class="system-status status-normal">正常运行</div>
                        <div class="system-stats">
                            <div class="stat-item">
                                <span class="stat-value">234</span>
                                <span class="stat-label">本月爆料</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-value">95.2%</span>
                                <span class="stat-label">处理率</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-value">APP</span>
                                <span class="stat-label">支持手机</span>
                            </div>
                        </div>
                    </div>

                    <!-- 驿站管理 -->
                    <div class="system-card" data-service="station-management">
                        <div class="system-icon">🛖</div>
                        <div class="system-name">驿站管理</div>
                        <div class="system-status status-normal">正常运行</div>
                        <div class="system-stats">
                            <div class="stat-item">
                                <span class="stat-value">18</span>
                                <span class="stat-label">便民驿站</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-value">1,234</span>
                                <span class="stat-label">月访问量</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-value">APP</span>
                                <span class="stat-label">支持手机</span>
                            </div>
                        </div>
                    </div>

                    <!-- 新闻管理 -->
                    <div class="system-card" data-service="news-management">
                        <div class="system-icon">📰</div>
                        <div class="system-name">新闻管理</div>
                        <div class="system-status status-normal">正常运行</div>
                        <div class="system-stats">
                            <div class="stat-item">
                                <span class="stat-value">67</span>
                                <span class="stat-label">新闻资讯</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-value">15</span>
                                <span class="stat-label">本月发布</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-value">APP</span>
                                <span class="stat-label">支持手机</span>
                            </div>
                        </div>
                    </div>

                    <!-- 道路积水点 -->
                    <div class="system-card" data-service="water-logging">
                        <div class="system-icon">💧</div>
                        <div class="system-name">道路积水点</div>
                        <div class="system-status status-normal">正常运行</div>
                        <div class="system-stats">
                            <div class="stat-item">
                                <span class="stat-value">32</span>
                                <span class="stat-label">积水监测点</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-value">5</span>
                                <span class="stat-label">当前预警</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-value">APP</span>
                                <span class="stat-label">支持手机</span>
                            </div>
                        </div>
                    </div>

                    <!-- 政策法规 -->
                    <div class="system-card" data-service="policies">
                        <div class="system-icon">📜</div>
                        <div class="system-name">政策法规</div>
                        <div class="system-status status-normal">正常运行</div>
                        <div class="system-stats">
                            <div class="stat-item">
                                <span class="stat-value">45</span>
                                <span class="stat-label">政策文件</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-value">12</span>
                                <span class="stat-label">法规条例</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-value">APP</span>
                                <span class="stat-label">支持手机</span>
                            </div>
                        </div>
                    </div>

                    <!-- 爆料模板 -->
                    <div class="system-card" data-service="report-templates">
                        <div class="system-icon">📋</div>
                        <div class="system-name">爆料模板</div>
                        <div class="system-status status-normal">正常运行</div>
                        <div class="system-stats">
                            <div class="stat-item">
                                <span class="stat-value">8</span>
                                <span class="stat-label">爆料类型</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-value">100%</span>
                                <span class="stat-label">使用率</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-value">后台</span>
                                <span class="stat-label">管理入口</span>
                            </div>
                        </div>
                    </div>

                    <!-- 公厕管理 -->
                    <div class="system-card" data-service="toilet-management">
                        <div class="system-icon">🚻</div>
                        <div class="system-name">公厕管理</div>
                        <div class="system-status status-normal">正常运行</div>
                        <div class="system-stats">
                            <div class="stat-item">
                                <span class="stat-value">67</span>
                                <span class="stat-label">公共厕所</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-value">89.5%</span>
                                <span class="stat-label">清洁率</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-value">APP</span>
                                <span class="stat-label">支持手机</span>
                            </div>
                        </div>
                    </div>

                    <!-- 每日一题 -->
                    <div class="system-card" data-service="daily-question">
                        <div class="system-icon">❓</div>
                        <div class="system-name">每日一题</div>
                        <div class="system-status status-normal">正常运行</div>
                        <div class="system-stats">
                            <div class="stat-item">
                                <span class="stat-value">234</span>
                                <span class="stat-label">题目总数</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-value">125</span>
                                <span class="stat-label">今日参与</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-value">APP</span>
                                <span class="stat-label">支持手机</span>
                            </div>
                        </div>
                    </div>

                    <!-- 统计 -->
                    <div class="system-card" data-service="statistics">
                        <div class="system-icon">📊</div>
                        <div class="system-name">统计</div>
                        <div class="system-status status-normal">正常运行</div>
                        <div class="system-stats">
                            <div class="stat-item">
                                <span class="stat-value">15</span>
                                <span class="stat-label">高发区域</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-value">23</span>
                                <span class="stat-label">活跃用户</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-value">实时</span>
                                <span class="stat-label">数据更新</span>
                            </div>
                        </div>
                    </div>
                </div>

   
            </div>
        </div>

        <footer>
            <p>&copy; 2026 智慧城市管理平台. 实时数据更新中...</p>
        </footer>
    </div>

    <script type="text/javascript">
        // 页面加载动画
        window.addEventListener('load', function() {
            document.body.style.opacity = '0';
            document.body.style.transition = 'opacity 0.5s ease';
            setTimeout(() => {
                document.body.style.opacity = '1';
                
                // 页面加载完成后默认显示所有监控点列表
                const monitorListContent = document.getElementById('monitor-list-content');
                if (monitorListContent) {
                    monitorListContent.innerHTML = generateMonitorList('all');
                }

                // 初始化各个模块的数据
                initPersonnelModule();
                initMaintenanceModule();
                initIncidentModule();
                initDecisionModule();
                initSummaryModule();
                initPublicServiceModule();
            }, 100);
        });

        // 标签页切换功能
        const tabBtns = document.querySelectorAll('.tab-btn');
        var tabContents = document.querySelectorAll('.tab-content');
        
        // 用于跟踪已初始化的标签页图表
        var initializedTabs = new Set(['overview']); // overview标签页默认显示，需要初始化为已初始化

        tabBtns.forEach(btn => {
            btn.addEventListener('click', function() {
                // 更新按钮状态
                tabBtns.forEach(b => b.classList.remove('active'));
                this.classList.add('active');

                // 切换内容显示
                const targetTab = this.dataset.tab;
                tabContents.forEach(content => {
                    content.classList.remove('active');
                });
                document.getElementById(targetTab).classList.add('active');
                
                // 如果该标签页的图表尚未初始化，则初始化它
                if (!initializedTabs.has(targetTab)) {
                    initTabCharts(targetTab);
                    initializedTabs.add(targetTab);
                }
            });
        });
        
        // 初始化特定标签页的图表
        function initTabCharts(tabId) {
            const chartsToInit = [];
            
            // 根据标签页ID确定需要初始化的图表
            if (tabId === 'decision') {
                chartsToInit.push('lighting-region-chart', 'parking-region-chart', 'environment-comprehensive-chart');
            } else if (tabId === 'summary') {
                chartsToInit.push('incident-type-chart', 'incident-trend-chart', 'department-distribution-chart', 'region-distribution-chart');
            }
            
            // 初始化指定的图表
            chartsToInit.forEach(svgId => {
                const svg = document.getElementById(svgId);
                if (!svg) return;
                
                const rect = svg.getBoundingClientRect();
                const config = chartConfigs[svgId];
                
                // 确保获取到正确的尺寸
                const width = rect.width || 400;
                const height = rect.height || 350;
                
                const chart = new LineChart(svgId, width, height);
                chart.generateData(config.points, config.min, config.max);
                chart.draw();
                charts.push(chart);
            });
        }

        // 地图控制按钮切换
        const controlBtns = document.querySelectorAll('.control-btn');
        const monitorPoints = document.querySelectorAll('.monitor-point');
        const incidentMarkers = document.querySelectorAll('.incident-marker');
        const monitorListContent = document.getElementById('monitor-list-content');
        
        // 类型映射
        const typeMap = {
            '交通监控': 'traffic',
            '环卫设施': 'environment',
            '市政设施': 'municipal',
            '排水系统': 'drainage',
            '照明系统': 'lighting',
            '停车场': 'parking'
        };
        
        // 监控点模拟数据
        const monitorData = {
            'traffic': [
                { name: '交通监控点T001', status: 'normal', position: 'XX大道与XX路交叉口', type: 'traffic' },
                { name: '交通监控点T002', status: 'normal', position: 'XX环路东段', type: 'traffic' },
                { name: '交通监控点T003', status: 'alert', position: 'XX隧道出口', type: 'traffic' },
                { name: '交通监控点T004', status: 'normal', position: 'XX商圈周边', type: 'traffic' },
                { name: '交通监控点T005', status: 'normal', position: 'XX火车站广场', type: 'traffic' }
            ],
            'environment': [
                { name: '环卫设施E001', status: 'normal', position: 'XX公园北门', type: 'environment' },
                { name: '环卫设施E002', status: 'alert', position: 'XX街道35号', type: 'environment' },
                { name: '环卫设施E003', status: 'normal', position: 'XX小区东门', type: 'environment' },
                { name: '环卫设施E004', status: 'normal', position: 'XX地铁站出口', type: 'environment' }
            ],
            'municipal': [
                { name: '市政设施M001', status: 'normal', position: 'XX广场中心', type: 'municipal' },
                { name: '市政设施M002', status: 'normal', position: 'XX街道井盖', type: 'municipal' },
                { name: '市政设施M003', status: 'normal', position: 'XX公园座椅', type: 'municipal' },
                { name: '市政设施M004', status: 'normal', position: 'XX路口交通设施', type: 'municipal' }
            ],
            'drainage': [
                { name: '排水系统D001', status: 'normal', position: 'XX小区排水口', type: 'drainage' },
                { name: '排水系统D002', status: 'alert', position: 'XX街道排水站', type: 'drainage' },
                { name: '排水系统D003', status: 'normal', position: 'XX广场排水口', type: 'drainage' },
                { name: '排水系统D004', status: 'normal', position: 'XX公园湖泊', type: 'drainage' }
            ],
            'lighting': [
                { name: '照明系统L001', status: 'normal', position: 'XX路路灯', type: 'lighting' },
                { name: '照明系统L002', status: 'normal', position: 'XX大道东段路灯', type: 'lighting' },
                { name: '照明系统L003', status: 'normal', position: 'XX隧道照明', type: 'lighting' },
                { name: '照明系统L004', status: 'normal', position: 'XX广场景观灯', type: 'lighting' }
            ],
            'parking': [
                { name: '停车场P001', status: 'normal', position: 'XX商圈停车场', type: 'parking' },
                { name: '停车场P002', status: 'alert', position: 'XX医院停车场', type: 'parking' },
                { name: '停车场P003', status: 'normal', position: 'XX地铁站停车场', type: 'parking' },
                { name: '停车场P004', status: 'normal', position: 'XX公园停车场', type: 'parking' }
            ]
        };
        
        // 生成监控点列表
        function generateMonitorList(type) {
            let data = [];
            
            if (type === 'all') {
                // 合并所有数据
                Object.values(monitorData).forEach(typeData => {
                    data = data.concat(typeData);
                });
            } else {
                data = monitorData[type] || [];
            }
            
            if (data.length === 0) {
                return '<p>该类型暂无监控点数据</p>';
            }
            
            // 生成HTML
            let html = '<div class="monitor-items">';
            data.forEach(item => {
                const statusText = item.status === 'normal' ? '正常' : '异常';
                const statusClass = item.status === 'normal' ? 'status-normal' : 'status-alert';
                
                html += `
                    <div class="monitor-item ${item.type}">
                        <div class="monitor-info">
                            <span class="monitor-name">${item.name}</span>
                            <span class="monitor-status">状态：<span class="${statusClass}">${statusText}</span></span>
                        </div>
                        <span class="monitor-position">${item.position}</span>
                    </div>
                `;
            });
            html += '</div>';
            
            return html;
        }
        
        controlBtns.forEach(btn => {
            btn.addEventListener('click', function() {
                // 更新按钮状态
                controlBtns.forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                
                const btnText = this.textContent;
                
                // 显示/隐藏监控点
                if (btnText === '全部显示') {
                    // 显示所有监控点
                    monitorPoints.forEach(point => {
                        point.style.display = 'block';
                    });
                    // 显示所有事件标记
                    incidentMarkers.forEach(marker => {
                        marker.style.display = 'flex';
                    });
                    // 显示所有监控点列表
                    monitorListContent.innerHTML = generateMonitorList('all');
                } else {
                    // 只显示对应类型的监控点
                    const targetType = typeMap[btnText];
                    
                    monitorPoints.forEach(point => {
                        if (point.classList.contains(targetType)) {
                            point.style.display = 'block';
                        } else {
                            point.style.display = 'none';
                        }
                    });
                    
                    // 事件标记与监控点类型对应关系
                    const incidentTypeMap = {
                        'traffic': ['交通拥堵'],
                        'environment': ['垃圾满溢'],
                        'municipal': [],
                        'drainage': [],
                        'lighting': [],
                        'parking': []
                    };
                    
                    // 显示/隐藏事件标记
                    incidentMarkers.forEach(marker => {
                        const incidentType = marker.dataset.type;
                        if (incidentTypeMap[targetType] && incidentTypeMap[targetType].includes(incidentType)) {
                            marker.style.display = 'flex';
                        } else {
                            marker.style.display = 'none';
                        }
                    });
                    
                    // 显示对应类型的监控点列表
                    monitorListContent.innerHTML = generateMonitorList(targetType);
                }
            });
        });

        // 系统卡片点击事件
        const systemCards = document.querySelectorAll('.system-card');
        systemCards.forEach(card => {
            card.addEventListener('click', function() {
                const systemName = this.querySelector('.system-name').textContent;
                const systemMap = {
                    '智慧街面': 'smart-street.html',
                    '智慧环卫': 'smart-environment.html',
                    '智慧市政': 'smart-municipal.html',
                    '智慧排水': 'smart-drainage.html',
                    '智慧照明': 'smart-lighting.html',
                    '智慧停车': 'smart-parking.html'
                };
                
                if (systemMap[systemName]) {
                    document.body.style.opacity = '0';
                    setTimeout(() => {
                        window.location.href = systemMap[systemName];
                    }, 300);
                }
            });
        });

        // 数字动画效果
        function animateNumbers() {
            const metricValues = document.querySelectorAll('.metric-value');
            metricValues.forEach(value => {
                const text = value.textContent;
                if (text.includes('%')) {
                    const target = parseFloat(text);
                    let current = 0;
                    const increment = target / 50;
                    const timer = setInterval(() => {
                        current += increment;
                        if (current >= target) {
                            value.textContent = target.toFixed(1) + '%';
                            clearInterval(timer);
                        } else {
                            value.textContent = current.toFixed(1) + '%';
                        }
                    }, 30);
                } else if (text.includes(',')) {
                    const target = parseInt(text.replace(',', ''));
                    let current = 0;
                    const increment = target / 50;
                    const timer = setInterval(() => {
                        current += increment;
                        if (current >= target) {
                            value.textContent = target.toLocaleString();
                            clearInterval(timer);
                        } else {
                            value.textContent = Math.floor(current).toLocaleString();
                        }
                    }, 30);
                }
            });
        }

        // 页面加载完成后执行数字动画
        setTimeout(animateNumbers, 500);

        // 实时更新时间
        function updateTime() {
            const now = new Date();
            const timeStr = now.toLocaleString('zh-CN');
            const footer = document.querySelector('footer p');
            footer.textContent = `© 2026 智慧城市管理平台. 实时数据更新中... ${timeStr}`;
        }

        setInterval(updateTime, 1000);

        // 模拟预警数据生成
        const alertTemplates = [
            { type: 'critical', title: 'XX路段交通拥堵', content: '拥堵指数：%congestion%，预计持续时间：%duration%分钟', locations: ['XX大道与XX路交叉口', 'XX环路东段', 'XX隧道出口', 'XX商圈周边'], congestion: [80, 85, 90, 95], duration: [20, 30, 40, 50] },
            { type: 'warning', title: 'XX区域垃圾桶满溢', content: '位置：%location%，已满程度：%fullness%', locations: ['XX公园北门', 'XX街道35号', 'XX小区东门', 'XX地铁站出口'], fullness: ['85%', '90%', '95%', '100%'] },
            { type: 'info', title: '照明系统维护提醒', content: '%location%需要维护检查', locations: ['XX路10盏路灯', 'XX大道东段路灯', 'XX隧道照明', 'XX广场景观灯'] },
            { type: 'critical', title: 'XX排水口流量异常', content: '当前流量：%flow%，超过警戒值', locations: ['XX小区', 'XX街道', 'XX广场', 'XX公园'], flow: ['110%', '120%', '130%', '140%'] },
            { type: 'warning', title: 'XX停车场车位紧张', content: '当前剩余车位：%spots%/%total%，建议引导至附近停车场', locations: ['XX商圈停车场', 'XX医院停车场', 'XX地铁站停车场', 'XX公园停车场'], spots: [5, 8, 10, 12], total: [100, 150, 200, 250] },
            { type: 'info', title: '市政设施巡检提醒', content: '%location%需要定期巡检', locations: ['XX广场公共设施', 'XX街道井盖', 'XX公园座椅', 'XX路口交通设施'] },
            { type: 'critical', title: 'XX路段井盖异常', content: '位置：%location%，检测到异常位移', locations: ['XX大道288号', 'XX路156号', 'XX街89号', 'XX巷32号'] },
            { type: 'warning', title: 'XX区域环境监测异常', content: 'PM2.5浓度：%pm25%μg/m³，接近警戒值', locations: ['XX工业区', 'XX交通枢纽', 'XX商圈', 'XX居民区'], pm25: [70, 75, 80, 85] }
        ];

        // 生成随机预警
        function generateRandomAlert() {
            const template = alertTemplates[Math.floor(Math.random() * alertTemplates.length)];
            const now = new Date();
            const timeStr = now.toLocaleString('zh-CN');
            
            let content = template.content;
            if (template.locations) {
                content = content.replace('%location%', template.locations[Math.floor(Math.random() * template.locations.length)]);
            }
            if (template.congestion) {
                content = content.replace('%congestion%', template.congestion[Math.floor(Math.random() * template.congestion.length)] + '%');
            }
            if (template.duration) {
                content = content.replace('%duration%', template.duration[Math.floor(Math.random() * template.duration.length)]);
            }
            if (template.fullness) {
                content = content.replace('%fullness%', template.fullness[Math.floor(Math.random() * template.fullness.length)]);
            }
            if (template.flow) {
                content = content.replace('%flow%', template.flow[Math.floor(Math.random() * template.flow.length)]);
            }
            if (template.spots) {
                const index = Math.floor(Math.random() * template.spots.length);
                content = content.replace('%spots%', template.spots[index]);
                content = content.replace('%total%', template.total[index]);
            }
            if (template.pm25) {
                content = content.replace('%pm25%', template.pm25[Math.floor(Math.random() * template.pm25.length)]);
            }

            return {
                type: template.type,
                title: template.title,
                content: content,
                time: timeStr
            };
        }

        // 更新预警信息
        function updateAlerts() {
            const alertsContainer = document.getElementById('alerts-container');
            
            // 生成新预警
            const newAlert = generateRandomAlert();
            const alertDiv = document.createElement('div');
            alertDiv.className = `alert-item ${newAlert.type === 'critical' ? '' : newAlert.type === 'warning' ? 'warning' : 'info'}`;
            alertDiv.innerHTML = `
                <div class="alert-title">${newAlert.title}</div>
                <div>${newAlert.content}</div>
                <div class="alert-time">${newAlert.time}</div>
            `;
            
            // 添加到顶部
            alertsContainer.insertBefore(alertDiv, alertsContainer.firstChild);
            
            // 限制预警数量
            const maxAlerts = 10;
            while (alertsContainer.children.length > maxAlerts) {
                alertsContainer.removeChild(alertsContainer.lastChild);
            }
        }

        // 每10秒更新一次预警
        setInterval(updateAlerts, 10000);

        // 子系统统计数据更新
        const systemStatsData = {
            'smart-street': {
                '在线设备': { min: 200, max: 300, step: 5 },
                '今日工单': { min: 10, max: 30, step: 1 },
                '运行率': { min: 95, max: 100, step: 0.5, suffix: '%' },
                '响应时间': { min: 8, max: 20, step: 1, suffix: 's' }
            },
            'smart-environment': {
                '垃圾桶数': { min: 100, max: 200, step: 10 },
                '满溢预警': { min: 20, max: 40, step: 2 },
                '运行率': { min: 90, max: 98, step: 0.5, suffix: '%' },
                '清理周期': { min: 6, max: 12, step: 1, suffix: 'h' }
            },
            'smart-municipal': {
                '设施总数': { min: 500, max: 700, step: 20 },
                '维护工单': { min: 20, max: 50, step: 2 },
                '完好率': { min: 95, max: 99, step: 0.2, suffix: '%' },
                '维修响应': { min: 24, max: 72, step: 6, suffix: 'h' }
            },
            'smart-drainage': {
                '监测点': { min: 80, max: 120, step: 5 },
                '异常点': { min: 2, max: 10, step: 1 },
                '运行率': { min: 85, max: 95, step: 0.5, suffix: '%' },
                '平均液位': { min: 0.5, max: 2, step: 0.1, suffix: 'm' }
            },
            'smart-lighting': {
                '路灯总数': { min: 1000, max: 1500, step: 50 },
                '故障灯': { min: 10, max: 30, step: 2 },
                '完好率': { min: 96, max: 99, step: 0.2, suffix: '%' },
                '维修响应': { min: 1, max: 6, step: 0.5, suffix: 'h' }
            },
            'smart-parking': {
                '总车位': { min: 5000, max: 6000, step: 100 },
                '已占用': { min: 3000, max: 4000, step: 50 },
                '运行率': { min: 98, max: 100, step: 0.1, suffix: '%' },
                '使用率': { min: 60, max: 80, step: 2, suffix: '%' }
            }
        };

        // 更新系统统计数据
        function updateSystemStats() {
            const systemCards = document.querySelectorAll('.system-card');
            systemCards.forEach(card => {
                const systemKey = card.dataset.system;
                if (!systemStatsData[systemKey]) return;

                const statItems = card.querySelectorAll('.stat-item');
                statItems.forEach((item, index) => {
                    const statLabel = item.querySelector('.stat-label').textContent;
                    const statValue = item.querySelector('.stat-value');
                    const dataConfig = systemStatsData[systemKey][statLabel];
                    
                    if (dataConfig) {
                        let newValue;
                        if (statLabel.includes('率') || statLabel.includes('液位')) {
                            newValue = (Math.random() * (dataConfig.max - dataConfig.min) + dataConfig.min).toFixed(1);
                        } else {
                            newValue = Math.floor(Math.random() * ((dataConfig.max - dataConfig.min) / dataConfig.step + 1)) * dataConfig.step + dataConfig.min;
                        }
                        
                        statValue.textContent = newValue + (dataConfig.suffix || '');
                    }
                });
            });
        }

        // 每30秒更新一次系统统计数据
        setInterval(updateSystemStats, 30000);

        // 指标卡片数据配置
        const metricsData = {
            'system-uptime': { min: 95, max: 100, step: 0.1, suffix: '%', current: 98.2 },
            'monitor-points': { min: 1000, max: 2000, step: 5, suffix: '', current: 1234 },
            'current-alerts': { min: 0, max: 50, step: 1, suffix: '', current: 8 },
            'problem-solve-rate': { min: 85, max: 98, step: 0.2, suffix: '%', current: 92.5 },
            'today-tickets': { min: 30, max: 100, step: 1, suffix: '', current: 56 },
            'online-devices': { min: 4000, max: 6000, step: 10, suffix: '', current: 4567 },
            'abnormal-devices': { min: 10, max: 50, step: 1, suffix: '', current: 12 },
            'offline-devices': { min: 30, max: 100, step: 1, suffix: '', current: 45 },
            'pending-tickets': { min: 20, max: 60, step: 1, suffix: '', current: 28 }
        };

        // 平滑更新数字动画
        function animateNumber(element, target, suffix = '', duration = 1000) {
            const start = parseFloat(element.textContent.replace(/[^0-9.]/g, '')) || 0;
            const change = target - start;
            const increment = change / (duration / 30);
            let current = start;
            
            const timer = setInterval(() => {
                current += increment;
                if ((increment > 0 && current >= target) || (increment < 0 && current <= target)) {
                    element.textContent = target.toLocaleString() + suffix;
                    clearInterval(timer);
                } else {
                    element.textContent = (increment > 0 ? Math.floor(current) : Math.ceil(current)).toLocaleString() + suffix;
                }
            }, 30);
        }

        // 更新指标卡片数据
        function updateMetrics() {
            Object.keys(metricsData).forEach(metricKey => {
                const config = metricsData[metricKey];
                const newTarget = Math.random() * (config.max - config.min) + config.min;
                const roundedTarget = config.suffix.includes('%') ? newTarget.toFixed(1) : Math.floor(newTarget);
                
                const card = document.querySelector(`[data-metric="${metricKey}"]`);
                const valueElement = card.querySelector('.metric-value');
                const trendElement = card.querySelector('.metric-trend');
                
                if (valueElement && trendElement) {
                    // 更新数值
                    animateNumber(valueElement, parseFloat(roundedTarget), config.suffix);
                    
                    // 更新趋势
                    const oldValue = config.current;
                    const newValue = parseFloat(roundedTarget);
                    const diff = Math.abs(newValue - oldValue).toFixed(1);
                    
                    if (newValue > oldValue) {
                        trendElement.className = 'metric-trend trend-up';
                        trendElement.innerHTML = `<span>↑</span><span>${diff}${config.suffix}</span>`;
                    } else if (newValue < oldValue) {
                        trendElement.className = 'metric-trend trend-down';
                        trendElement.innerHTML = `<span>↓</span><span>${diff}${config.suffix}</span>`;
                    }
                    
                    // 更新当前值
                    config.current = newValue;
                }
            });
        }

        // 每15秒更新一次指标卡片
        setInterval(updateMetrics, 15000);

        // 图表功能
        function LineChart(svgId, width, height) {
            this.svg = document.getElementById(svgId);
            this.width = width;
            this.height = height;
            this.margin = { top: 20, right: 30, bottom: 60, left: 50 };
            this.data = [];
        }

        // 生成随机数据
        LineChart.prototype.generateData = function(points, min, max) {
            points = points || 24;
            min = min || 0;
            max = max || 100;
            this.data = [];
            for (var i = 0; i < points; i++) {
                this.data.push(Math.random() * (max - min) + min);
            }
        };

        // 绘制图表
        LineChart.prototype.draw = function() {
            if (this.data.length === 0) return;

            // 清除现有内容
            this.svg.innerHTML = '';
            
            // 重新获取最新的元素尺寸，确保使用正确的宽度
            var rect = this.svg.getBoundingClientRect();
            this.width = rect.width || 400;
            this.height = rect.height || 350;

            var innerWidth = this.width - this.margin.left - this.margin.right;
            var innerHeight = this.height - this.margin.top - this.margin.bottom;

            // 创建分组
            var g = document.createElementNS('http://www.w3.org/2000/svg', 'g');
            g.setAttribute('transform', 'translate(' + this.margin.left + ', ' + this.margin.top + ')');
            this.svg.appendChild(g);

            // 计算数据范围
            var maxValue = Math.max.apply(null, this.data);
            var minValue = Math.min.apply(null, this.data);
            var padding = (maxValue - minValue) * 0.1;

            // 绘制网格线
            for (var i = 0; i <= 5; i++) {
                var y = (innerHeight / 5) * i;
                var gridLine = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                gridLine.setAttribute('x1', 0);
                gridLine.setAttribute('y1', y);
                gridLine.setAttribute('x2', innerWidth);
                gridLine.setAttribute('y2', y);
                gridLine.setAttribute('class', 'chart-grid');
                g.appendChild(gridLine);
            }

            // 绘制坐标轴
            var xAxis = document.createElementNS('http://www.w3.org/2000/svg', 'line');
            xAxis.setAttribute('x1', 0);
            xAxis.setAttribute('y1', innerHeight);
            xAxis.setAttribute('x2', innerWidth);
            xAxis.setAttribute('y2', innerHeight);
            xAxis.setAttribute('class', 'chart-axis');
            g.appendChild(xAxis);

            var yAxis = document.createElementNS('http://www.w3.org/2000/svg', 'line');
            yAxis.setAttribute('x1', 0);
            yAxis.setAttribute('y1', 0);
            yAxis.setAttribute('x2', 0);
            yAxis.setAttribute('y2', innerHeight);
            yAxis.setAttribute('class', 'chart-axis');
            g.appendChild(yAxis);

            // 绘制折线
            var pathData = [];
            for (var index = 0; index < this.data.length; index++) {
                var value = this.data[index];
                var x = (innerWidth / (this.data.length - 1)) * index;
                var y = innerHeight - ((value - minValue + padding) / (maxValue - minValue + padding * 2)) * innerHeight;
                pathData.push((index === 0 ? 'M' : 'L') + ' ' + x + ' ' + y);
            }
            pathData = pathData.join(' ');

            var line = document.createElementNS('http://www.w3.org/2000/svg', 'path');
            line.setAttribute('d', pathData);
            line.setAttribute('class', 'chart-line');
            g.appendChild(line);

            // 绘制区域
            var areaPathData = pathData + ' L ' + innerWidth + ' ' + innerHeight + ' L 0 ' + innerHeight + ' Z';
            var area = document.createElementNS('http://www.w3.org/2000/svg', 'path');
            area.setAttribute('d', areaPathData);
            area.setAttribute('class', 'chart-area');
            g.appendChild(area);
            
            // 计算合适的标签间隔，确保标签数量合理
            var maxLabels = 12;
            var numLabels;
            
            // 根据数据长度和可用宽度计算最佳标签数量
            if (this.data.length <= maxLabels) {
                numLabels = this.data.length;
            } else {
                numLabels = maxLabels;
            }
            
            // 确保至少显示第一个和最后一个标签
            var labelsToShow = [0];
            
            // 计算标签间隔，确保均匀分布
            if (numLabels > 2) {
                var step = Math.floor(this.data.length / (numLabels - 1));
                for (var i = step; i < this.data.length - 1; i += step) {
                    labelsToShow.push(i);
                }
            }
            
            // 确保最后一个点也有标签
            if (labelsToShow[labelsToShow.length - 1] !== this.data.length - 1) {
                labelsToShow.push(this.data.length - 1);
            }
            
            // 根据标签数量决定旋转角度
            var labelRotation = labelsToShow.length > 8 ? -45 : 0;
            
            for (var j = 0; j < labelsToShow.length; j++) {
                var i = labelsToShow[j];
                // 计算X坐标，确保标签均匀分布在整个宽度上
                var x = (innerWidth / (this.data.length - 1)) * i;
                var label = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                label.setAttribute('x', x);
                
                // 根据旋转角度设置Y坐标和文本定位
                if (labelRotation !== 0) {
                    label.setAttribute('y', innerHeight + 40); // 增加Y轴偏移量，为旋转标签留出空间
                    label.setAttribute('transform', 'rotate(' + labelRotation + ' ' + x + ' ' + (innerHeight + 40) + ')');
                    label.setAttribute('text-anchor', 'end');
                } else {
                    label.setAttribute('y', innerHeight + 20);
                    label.setAttribute('text-anchor', 'middle');
                }
                
                label.setAttribute('class', 'chart-label');
                
                // 根据图表类型显示合适的标签
                var chartId = this.svg.id;
                if (chartId.indexOf('lighting') !== -1 || chartId.indexOf('parking') !== -1 || chartId.indexOf('environment') !== -1) {
                    // 区域或设备类型图表
                    label.textContent = '区域' + (i + 1);
                } else if (chartId.indexOf('incident-type') !== -1) {
                    // 事件类型图表
                    var incidentTypes = ['交通', '环卫', '井盖', '路灯', '排水', '违章', '占道', '绿化', '设施', '广告', '动物', '噪音'];
                    label.textContent = incidentTypes[i % incidentTypes.length];
                } else if (chartId.indexOf('incident-trend') !== -1) {
                    // 事件趋势图表（天数）
                    label.textContent = i + '天';
                } else if (chartId.indexOf('department-distribution') !== -1) {
                    // 部门分布图表
                    var departments = ['交通管理', '环卫清洁', '市政维护', '排水管理', '照明管理', '综合执法'];
                    label.textContent = departments[i % departments.length];
                } else if (chartId.indexOf('region-distribution') !== -1) {
                    // 区域分布图表
                    var regions = ['东区', '南区', '西区', '北区', '中心区'];
                    label.textContent = regions[i % regions.length];
                } else {
                    // 时间序列图表
                    label.textContent = i + ':00';
                }
                
                g.appendChild(label);
            }
        };

        // 更新数据并重新绘制
        LineChart.prototype.update = function() {
            this.generateData();
            this.draw();
        };

        // 初始化图表
        var charts = [];
        
        // 图表配置
        var chartConfigs = {
            'tickets-chart': { points: 24, min: 5, max: 50, label: '工单' },
            'devices-chart': { points: 24, min: 90, max: 100, label: '设备在线率' },
            'lighting-region-chart': { points: 5, min: 50, max: 200, label: '路灯数量' },
            'parking-region-chart': { points: 8, min: 30, max: 200, label: '停车位' },
            'environment-comprehensive-chart': { points: 12, min: 10, max: 150, label: '环卫设备' },
            'incident-type-chart': { points: 12, min: 30, max: 150, label: '事件类型' },
            'incident-trend-chart': { points: 30, min: 10, max: 100, label: '事件数量' },
            'department-distribution-chart': { points: 6, min: 50, max: 300, label: '部门处理' },
            'region-distribution-chart': { points: 5, min: 100, max: 400, label: '区域分布' }
        };
        
        // 统一初始化所有图表
        function initAllCharts() {
            // 只初始化overview标签页的图表，其他标签页的图表在用户切换时初始化
            const overviewCharts = ['tickets-chart', 'devices-chart'];
            
            overviewCharts.forEach(svgId => {
                const svg = document.getElementById(svgId);
                if (!svg) return;
                
                const rect = svg.getBoundingClientRect();
                const config = chartConfigs[svgId];
                
                // 确保获取到正确的尺寸
                const width = rect.width || 400;
                const height = rect.height || 350;
                
                const chart = new LineChart(svgId, width, height);
                chart.generateData(config.points, config.min, config.max);
                chart.draw();
                charts.push(chart);
            });
        }
        
        // 页面加载完成后初始化图表
        window.addEventListener('load', () => {
            // 延迟一点时间，确保元素都已渲染
            setTimeout(initAllCharts, 100);
        });

        // 窗口大小变化时重新绘制图表
        window.addEventListener('resize', () => {
            charts.forEach(chart => {
                const svg = document.getElementById(chart.svg.id);
                if (!svg) return;
                
                const rect = svg.getBoundingClientRect();
                chart.width = rect.width || 400;
                chart.height = rect.height || 350;
                chart.draw();
            });
        });

        // 每60秒更新一次图表
        setInterval(() => {
            charts.forEach(chart => chart.update());
        }, 60000);

        // ------------------------------
        // 人员考核模块
        // ------------------------------
        function initPersonnelModule() {
            // 生成考核排名数据
            const rankingData = generatePersonnelRanking(10);
            renderPersonnelRanking(rankingData);

            // 更新考核指标数据
            updatePersonnelMetrics(rankingData);

            // 添加搜索功能
            const searchBtn = document.querySelector('.search-btn');
            const searchInput = document.getElementById('personnel-search-input');
            const departmentFilter = document.getElementById('department-filter');
            const scoreRange = document.getElementById('score-range');
            const tasksRange = document.getElementById('tasks-range');
            const satisfactionRange = document.getElementById('satisfaction-range');
            const searchResult = document.getElementById('personnel-search-result');

            // 初始化范围滑块
            initRangeSliders();

            // 搜索函数
            function performSearch() {
                const keyword = searchInput.value.trim();
                const department = departmentFilter.value;
                
                // 构建搜索参数
                const searchParams = {
                    keyword: keyword,
                    department: department,
                    scoreRange: {
                        min: parseFloat(scoreRange.value),
                        max: 100
                    },
                    tasksRange: {
                        min: parseInt(tasksRange.value),
                        max: 100
                    },
                    satisfactionRange: {
                        min: parseFloat(satisfactionRange.value),
                        max: 100
                    }
                };

                // 执行搜索
                const result = searchPersonnel(searchParams, rankingData);
                renderSearchResult(result, searchResult);
            }

            if (searchBtn && searchInput && departmentFilter && scoreRange && tasksRange && satisfactionRange && searchResult) {
                // 搜索按钮点击事件
                searchBtn.addEventListener('click', performSearch);

                // 回车键搜索
                searchInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        performSearch();
                    }
                });

                // 部门筛选变化事件
                departmentFilter.addEventListener('change', performSearch);

                // 范围滑块变化事件
                scoreRange.addEventListener('input', performSearch);
                tasksRange.addEventListener('input', performSearch);
                satisfactionRange.addEventListener('input', performSearch);
            }

            // 添加排名更新功能
            const updateBtn = document.createElement('button');
            updateBtn.textContent = '更新排名';
            updateBtn.className = 'search-btn';
            updateBtn.style.marginLeft = '10px';
            const searchControls = document.querySelector('.search-controls');
            if (searchControls) {
                searchControls.appendChild(updateBtn);

                updateBtn.addEventListener('click', function() {
                    const newRankingData = generatePersonnelRanking(10);
                    renderPersonnelRanking(newRankingData);
                    updatePersonnelMetrics(newRankingData);
                    alert('考核排名已更新');
                });
            }
        }

        // 更新考核指标数据
        function updatePersonnelMetrics(data) {
            // 更新平均考核得分
            const avgScore = (data.reduce((sum, item) => sum + parseFloat(item.score), 0) / data.length).toFixed(1);
            const avgScoreCard = document.querySelector('.personnel-metrics .metric-card:nth-child(1) .metric-value');
            if (avgScoreCard) {
                avgScoreCard.textContent = avgScore + '%';
            }

            // 更新考核人员总数（模拟总人数）
            const totalPersonnel = Math.floor(Math.random() * 50) + 100;
            const totalPersonnelCard = document.querySelector('.personnel-metrics .metric-card:nth-child(2) .metric-value');
            if (totalPersonnelCard) {
                totalPersonnelCard.textContent = totalPersonnel;
            }

            // 更新任务完成率
            const completionRate = (Math.random() * 10 + 85).toFixed(1);
            const completionRateCard = document.querySelector('.personnel-metrics .metric-card:nth-child(3) .metric-value');
            if (completionRateCard) {
                completionRateCard.textContent = completionRate + '%';
            }

            // 更新待考核人员
            const pendingPersonnel = Math.floor(Math.random() * 20) + 5;
            const pendingPersonnelCard = document.querySelector('.personnel-metrics .metric-card:nth-child(4) .metric-value');
            if (pendingPersonnelCard) {
                pendingPersonnelCard.textContent = pendingPersonnel;
            }
        }

        // 生成人员考核排名数据
        function generatePersonnelRanking(count) {
            const departments = ['交通管理', '环卫清洁', '市政维护', '排水管理', '照明管理', '停车场管理'];
            const names = ['张三', '李四', '王五', '赵六', '钱七', '孙八', '周九', '吴十', '郑一', '王二'];
            const data = [];

            for (let i = 0; i < count; i++) {
                // 为每个人员生成详细的考核记录
                const assessmentRecords = generateAssessmentRecords(3);
                
                data.push({
                    id: 'EMP' + String(i + 1001).padStart(4, '0'),
                    rank: i + 1,
                    name: names[i % names.length] + (i >= names.length ? i + 1 : ''),
                    department: departments[Math.floor(Math.random() * departments.length)],
                    score: (85 + Math.random() * 15).toFixed(1),
                    completedTasks: Math.floor(Math.random() * 50) + 30,
                    satisfaction: (80 + Math.random() * 20).toFixed(1),
                    onDutyRate: (95 + Math.random() * 5).toFixed(1),
                    punctualityRate: (90 + Math.random() * 10).toFixed(1),
                    assessmentRecords: assessmentRecords
                });
            }

            // 按分数排序
            return data.sort((a, b) => parseFloat(b.score) - parseFloat(a.score));
        }

        // 生成考核记录
        function generateAssessmentRecords(count) {
            const records = [];
            const assessmentTypes = ['日常考核', '月度考核', '季度考核', '专项考核'];
            
            for (let i = 0; i < count; i++) {
                const date = new Date();
                date.setDate(date.getDate() - Math.floor(Math.random() * 30 * (i + 1)));
                
                records.push({
                    type: assessmentTypes[Math.floor(Math.random() * assessmentTypes.length)],
                    date: date.toISOString().split('T')[0],
                    score: (80 + Math.random() * 20).toFixed(1),
                    evaluator: '考核组' + (i + 1),
                    comment: generateAssessmentComment()
                });
            }
            
            return records;
        }

        // 生成考核评语
        function generateAssessmentComment() {
            const comments = [
                '工作认真负责，任务完成质量高',
                '积极主动，能够及时解决问题',
                '团队合作精神强，值得表扬',
                '业务能力优秀，工作效率高',
                '需要加强沟通能力，提高服务质量',
                '工作态度良好，但需要提升专业技能',
                '能够按时完成任务，但细节处理需要加强',
                '表现出色，多次获得群众好评',
                '工作积极，能够主动承担额外任务',
                '需要提高工作效率，减少延误情况'
            ];
            
            return comments[Math.floor(Math.random() * comments.length)];
        }

        // 渲染人员考核排名
        function renderPersonnelRanking(data) {
            const tbody = document.getElementById('ranking-body');
            if (!tbody) return;

            let html = '';
            data.forEach((item, index) => {
                // 为前三名添加特殊样式
                let rankClass = '';
                if (item.rank === 1) rankClass = 'rank-first';
                else if (item.rank === 2) rankClass = 'rank-second';
                else if (item.rank === 3) rankClass = 'rank-third';
                
                html += `
                    <tr class="ranking-item ${rankClass}" data-id="${item.id}">
                        <td class="rank-cell">${item.rank}</td>
                        <td class="name-cell">${item.name}</td>
                        <td class="department-cell">${item.department}</td>
                        <td class="score-cell">${item.score}</td>
                        <td class="tasks-cell">${item.completedTasks}</td>
                        <td class="satisfaction-cell">${item.satisfaction}%</td>
                    </tr>
                `;
            });
            tbody.innerHTML = html;

            // 添加点击事件查看详情
            const rankingItems = document.querySelectorAll('.ranking-item');
            rankingItems.forEach(item => {
                item.addEventListener('click', function() {
                    const empId = this.getAttribute('data-id');
                    const empData = data.find(emp => emp.id === empId);
                    if (empData) {
                        showPersonnelDetail(empData);
                    }
                });
            });
        }

        // 显示人员详细信息
        function showPersonnelDetail(data) {
            let detailHtml = `
                <div style="max-width: 600px; margin: 0 auto;">
                    <h4 style="margin-bottom: 20px;">${data.name} - 详细考核信息</h4>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 20px;">
                        <div style="background: #f8f9fa; padding: 10px; border-radius: 5px;">
                            <strong>工号:</strong> ${data.id}
                        </div>
                        <div style="background: #f8f9fa; padding: 10px; border-radius: 5px;">
                            <strong>部门:</strong> ${data.department}
                        </div>
                        <div style="background: #f8f9fa; padding: 10px; border-radius: 5px;">
                            <strong>考核得分:</strong> ${data.score}
                        </div>
                        <div style="background: #f8f9fa; padding: 10px; border-radius: 5px;">
                            <strong>完成任务数:</strong> ${data.completedTasks}
                        </div>
                        <div style="background: #f8f9fa; padding: 10px; border-radius: 5px;">
                            <strong>服务满意度:</strong> ${data.satisfaction}%
                        </div>
                        <div style="background: #f8f9fa; padding: 10px; border-radius: 5px;">
                            <strong>出勤率:</strong> ${data.onDutyRate}%
                        </div>
                        <div style="background: #f8f9fa; padding: 10px; border-radius: 5px; grid-column: 1 / -1;">
                            <strong>准时率:</strong> ${data.punctualityRate}%
                        </div>
                    </div>
                    
                    <h5 style="margin-bottom: 15px;">考核记录:</h5>
                    <div style="max-height: 300px; overflow-y: auto; border: 1px solid #eee; border-radius: 5px; padding: 10px;">
            `;
            
            data.assessmentRecords.forEach(record => {
                detailHtml += `
                    <div style="background: white; padding: 10px; margin-bottom: 10px; border-radius: 5px; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                            <strong>${record.type}</strong>
                            <span style="color: #667eea;">${record.date}</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                            <span>得分: ${record.score}</span>
                            <span>考核人: ${record.evaluator}</span>
                        </div>
                        <div style="color: #666;">评语: ${record.comment}</div>
                    </div>
                `;
            });
            
            detailHtml += `
                    </div>
                    <div style="margin-top: 20px; text-align: center;">
                        <button id="close-detail" style="padding: 8px 20px; background: #667eea; color: white; border: none; border-radius: 5px; cursor: pointer;">关闭</button>
                    </div>
                </div>
            `;
            
            // 创建模态框
            const modal = document.createElement('div');
            modal.className = 'personnel-detail-modal';
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0,0,0,0.5);
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 1000;
            `;
            
            const modalContent = document.createElement('div');
            modalContent.style.cssText = `
                background: white;
                padding: 30px;
                border-radius: 10px;
                max-width: 90%;
                max-height: 90%;
                overflow-y: auto;
                position: relative;
            `;
            modalContent.innerHTML = detailHtml;
            
            modal.appendChild(modalContent);
            document.body.appendChild(modal);
            
            // 关闭模态框
            const closeBtn = modal.querySelector('#close-detail');
            closeBtn.addEventListener('click', function() {
                document.body.removeChild(modal);
            });
            
            // 点击外部关闭
            modal.addEventListener('click', function(e) {
                if (e.target === modal) {
                    document.body.removeChild(modal);
                }
            });
        }

        // 搜索人员
        function searchPersonnel(params, data) {
            const { keyword, department, scoreRange, tasksRange, satisfactionRange } = params;
            
            return data.filter(item => {
                // 关键词搜索（姓名、工号、部门）
                const matchesKeyword = !keyword || 
                    item.name.includes(keyword) || 
                    item.id.includes(keyword) ||
                    item.department.includes(keyword);
                
                // 部门筛选
                const matchesDepartment = !department || item.department === department;
                
                // 分数范围筛选
                const matchesScore = !scoreRange || 
                    (parseFloat(item.score) >= scoreRange.min && parseFloat(item.score) <= scoreRange.max);
                
                // 任务完成数筛选
                const matchesTasks = !tasksRange || 
                    (item.completedTasks >= tasksRange.min && item.completedTasks <= tasksRange.max);
                
                // 满意度筛选
                const matchesSatisfaction = !satisfactionRange || 
                    (parseFloat(item.satisfaction) >= satisfactionRange.min && parseFloat(item.satisfaction) <= satisfactionRange.max);
                
                return matchesKeyword && matchesDepartment && matchesScore && matchesTasks && matchesSatisfaction;
            });
        }

        // 渲染搜索结果
        function renderSearchResult(result, container) {
            if (result.length === 0) {
                container.innerHTML = '<p>未找到匹配的人员</p>';
                return;
            }

            let html = `<div class="search-result-header">找到 ${result.length} 位匹配人员</div>`;
            html += '<div class="search-result-list">';
            
            result.forEach(item => {
                // 添加等级标识
                let level = '普通';
                if (parseFloat(item.score) >= 95) level = '优秀';
                else if (parseFloat(item.score) >= 90) level = '良好';
                else if (parseFloat(item.score) >= 85) level = '合格';
                
                let levelClass = '';
                if (level === '优秀') levelClass = 'level-excellent';
                else if (level === '良好') levelClass = 'level-good';
                else if (level === '合格') levelClass = 'level-pass';
                
                html += `
                    <div class="search-result-item" data-id="${item.id}">
                        <div class="search-result-header">
                            <h5>${item.name} <span class="employee-id">(${item.id})</span></h5>
                            <span class="level-tag ${levelClass}">${level}</span>
                        </div>
                        <div class="search-result-info">
                            <div class="info-item">部门: ${item.department}</div>
                            <div class="info-item">考核得分: <strong style="color: #667eea;">${item.score}</strong></div>
                            <div class="info-item">完成任务: ${item.completedTasks}</div>
                            <div class="info-item">满意度: ${item.satisfaction}%</div>
                            <div class="info-item">出勤率: ${item.onDutyRate}%</div>
                            <div class="info-item">准时率: ${item.punctualityRate}%</div>
                        </div>
                        <div class="search-result-actions">
                            <button class="view-detail-btn" data-id="${item.id}">查看详情</button>
                        </div>
                    </div>
                `;
            });
            
            html += '</div>';
            container.innerHTML = html;
            
            // 添加查看详情事件
            const viewDetailBtns = container.querySelectorAll('.view-detail-btn');
            viewDetailBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    const empId = this.getAttribute('data-id');
                    // 这里需要获取完整数据，暂时使用当前结果中的数据
                    const empData = result.find(emp => emp.id === empId);
                    if (empData) {
                        showPersonnelDetail(empData);
                    }
                });
            });
        }

        // 初始化范围滑块
        function initRangeSliders() {
            // 分数范围滑块
            const scoreRange = document.getElementById('score-range');
            const scoreRangeText = document.getElementById('score-range-text');
            if (scoreRange && scoreRangeText) {
                // 使用两个滑块实现范围选择（简化版）
                scoreRange.addEventListener('input', function() {
                    const value = this.value;
                    scoreRangeText.textContent = `${value}-100`;
                });
            }
            
            // 任务完成数范围滑块
            const tasksRange = document.getElementById('tasks-range');
            const tasksRangeText = document.getElementById('tasks-range-text');
            if (tasksRange && tasksRangeText) {
                tasksRange.addEventListener('input', function() {
                    const value = this.value;
                    tasksRangeText.textContent = `${value}-100`;
                });
            }
            
            // 满意度范围滑块
            const satisfactionRange = document.getElementById('satisfaction-range');
            const satisfactionRangeText = document.getElementById('satisfaction-range-text');
            if (satisfactionRange && satisfactionRangeText) {
                satisfactionRange.addEventListener('input', function() {
                    const value = this.value;
                    satisfactionRangeText.textContent = `${value}-100%`;
                });
            }
        }

        // ------------------------------
        // 维护管理模块
        // ------------------------------
        function initMaintenanceModule() {
            // 生成维护计划数据
            const maintenancePlans = generateMaintenancePlans(8);
            renderMaintenancePlans(maintenancePlans);

            // 生成维护记录数据
            const maintenanceRecords = generateMaintenanceRecords(10);
            renderMaintenanceRecords(maintenanceRecords);
        }

        // 生成维护计划数据
        function generateMaintenancePlans(count) {
            const equipmentTypes = ['交通监控', '环卫设施', '市政设施', '排水系统', '照明系统', '停车场设备'];
            const maintenanceTypes = ['日常维护', '定期检修', '故障维修', '升级改造'];
            const responsiblePersons = ['维护组A', '维护组B', '维护组C', '技术组'];
            const data = [];

            for (let i = 0; i < count; i++) {
                const date = new Date();
                date.setDate(date.getDate() + Math.floor(Math.random() * 14));
                
                data.push({
                    id: 'MP' + String(i + 1001).padStart(4, '0'),
                    equipmentType: equipmentTypes[Math.floor(Math.random() * equipmentTypes.length)],
                    equipmentName: equipmentTypes[Math.floor(Math.random() * equipmentTypes.length)] + ' ' + Math.floor(Math.random() * 1000 + 1),
                    maintenanceType: maintenanceTypes[Math.floor(Math.random() * maintenanceTypes.length)],
                    scheduledDate: date.toISOString().split('T')[0],
                    responsiblePerson: responsiblePersons[Math.floor(Math.random() * responsiblePersons.length)],
                    status: Math.random() > 0.5 ? '待执行' : '已安排'
                });
            }

            return data;
        }

        // 渲染维护计划
        function renderMaintenancePlans(data) {
            const container = document.getElementById('maintenance-plans-list');
            if (!container) return;

            let html = '';
            data.forEach(item => {
                // 添加维护计划详情
                const planDetails = generatePlanDetails(item.maintenanceType);
                
                html += `
                    <div class="plan-item" data-plan-id="${item.id}">
                        <div class="plan-header">
                            <h5>${item.id} - ${item.equipmentName}</h5>
                            <span class="plan-status ${item.status === '待执行' ? 'status-pending' : 'status-scheduled'}">${item.status}</span>
                        </div>
                        <div class="plan-content">
                            <div class="plan-info">
                                <div class="info-item">
                                    <span class="info-label">设备类型:</span>
                                    <span class="info-value">${item.equipmentType}</span>
                                </div>
                                <div class="info-item">
                                    <span class="info-label">维护类型:</span>
                                    <span class="info-value">${item.maintenanceType}</span>
                                </div>
                                <div class="info-item">
                                    <span class="info-label">计划日期:</span>
                                    <span class="info-value">${item.scheduledDate}</span>
                                </div>
                                <div class="info-item">
                                    <span class="info-label">负责人:</span>
                                    <span class="info-value">${item.responsiblePerson}</span>
                                </div>
                                <div class="info-item full-width">
                                    <span class="info-label">维护内容:</span>
                                    <span class="info-value">${planDetails}</span>
                                </div>
                            </div>
                            <div class="plan-actions">
                                <button class="action-btn execute-btn" data-plan-id="${item.id}">执行</button>
                                <button class="action-btn delay-btn" data-plan-id="${item.id}">延期</button>
                                <button class="action-btn cancel-btn" data-plan-id="${item.id}">取消</button>
                            </div>
                        </div>
                    </div>
                `;
            });
            container.innerHTML = html;
            
            // 添加维护计划操作事件
            addPlanActionEvents(data);
        }

        // 生成维护计划详情
        function generatePlanDetails(maintenanceType) {
            const detailsMap = {
                '日常维护': '检查设备运行状态、清洁设备、更换易损部件、校准设备参数',
                '定期检修': '全面检查设备性能、更换磨损部件、进行设备测试和校准、更新设备固件',
                '故障维修': '排查故障原因、更换损坏部件、修复设备、进行功能测试',
                '升级改造': '设备硬件升级、软件更新、功能扩展、性能优化'
            };
            return detailsMap[maintenanceType] || '常规维护操作';
        }

        // 添加维护计划操作事件
        function addPlanActionEvents(plans) {
            const executeBtns = document.querySelectorAll('.execute-btn');
            const delayBtns = document.querySelectorAll('.delay-btn');
            const cancelBtns = document.querySelectorAll('.cancel-btn');
            
            // 执行维护计划
            executeBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    const planId = this.getAttribute('data-plan-id');
                    const plan = plans.find(p => p.id === planId);
                    if (plan) {
                        if (confirm(`确定要执行维护计划 ${plan.id} 吗？`)) {
                            plan.status = '执行中';
                            renderMaintenancePlans(plans);
                            alert(`维护计划 ${plan.id} 已开始执行`);
                        }
                    }
                });
            });
            
            // 延期维护计划
            delayBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    const planId = this.getAttribute('data-plan-id');
                    const plan = plans.find(p => p.id === planId);
                    if (plan) {
                        const newDate = prompt('请输入新的计划日期 (YYYY-MM-DD):', plan.scheduledDate);
                        if (newDate) {
                            // 简单验证日期格式
                            if (/^\d{4}-\d{2}-\d{2}$/.test(newDate)) {
                                plan.scheduledDate = newDate;
                                plan.status = '已安排';
                                renderMaintenancePlans(plans);
                                alert(`维护计划 ${plan.id} 已延期至 ${newDate}`);
                            } else {
                                alert('请输入有效的日期格式 (YYYY-MM-DD)');
                            }
                        }
                    }
                });
            });
            
            // 取消维护计划
            cancelBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    const planId = this.getAttribute('data-plan-id');
                    const plan = plans.find(p => p.id === planId);
                    if (plan) {
                        if (confirm(`确定要取消维护计划 ${plan.id} 吗？`)) {
                            plan.status = '已取消';
                            renderMaintenancePlans(plans);
                            alert(`维护计划 ${plan.id} 已取消`);
                        }
                    }
                });
            });
        }

        // 生成维护记录数据
        function generateMaintenanceRecords(count) {
            const equipmentTypes = ['交通监控', '环卫设施', '市政设施', '排水系统', '照明系统', '停车场设备'];
            const maintenanceTypes = ['日常维护', '定期检修', '故障维修', '升级改造'];
            const responsiblePersons = ['维护组A', '维护组B', '维护组C', '技术组'];
            const results = ['成功', '部分成功', '失败'];
            const data = [];

            for (let i = 0; i < count; i++) {
                const date = new Date();
                date.setDate(date.getDate() - Math.floor(Math.random() * 30));
                date.setHours(Math.floor(Math.random() * 24));
                date.setMinutes(Math.floor(Math.random() * 60));
                
                // 生成详细的维护记录信息
                const issue = generateMaintenanceIssue();
                const solution = generateMaintenanceSolution(issue);
                const materials = generateMaintenanceMaterials();
                
                data.push({
                    id: 'MR' + String(i + 2001).padStart(4, '0'),
                    equipmentType: equipmentTypes[Math.floor(Math.random() * equipmentTypes.length)],
                    equipmentName: equipmentTypes[Math.floor(Math.random() * equipmentTypes.length)] + ' ' + Math.floor(Math.random() * 1000 + 1),
                    maintenanceType: maintenanceTypes[Math.floor(Math.random() * maintenanceTypes.length)],
                    executionDate: date.toISOString().slice(0, 16).replace('T', ' '),
                    responsiblePerson: responsiblePersons[Math.floor(Math.random() * responsiblePersons.length)],
                    result: results[Math.floor(Math.random() * results.length)],
                    duration: Math.floor(Math.random() * 4) + 1 + '小时',
                    issue: issue,
                    solution: solution,
                    materials: materials,
                    cost: (Math.random() * 500 + 100).toFixed(2)
                });
            }

            return data;
        }

        // 生成维护问题
        function generateMaintenanceIssue() {
            const issues = [
                '设备运行不稳定，频繁重启',
                '传感器信号异常，数据采集不准确',
                '电源模块故障，设备无法启动',
                '网络连接中断，无法远程控制',
                '机械部件磨损，运行噪音过大',
                '软件版本过时，功能受限',
                '显示屏故障，无法正常显示',
                '开关按钮损坏，操作困难',
                '防水密封失效，内部进水',
                '散热系统故障，设备过热'
            ];
            return issues[Math.floor(Math.random() * issues.length)];
        }

        // 生成维护解决方案
        function generateMaintenanceSolution(issue) {
            const solutions = [
                '更换故障部件，重新校准设备',
                '修复传感器线路，调整灵敏度',
                '更换电源模块，进行功能测试',
                '重新配置网络参数，恢复连接',
                '更换磨损部件，添加润滑油脂',
                '升级软件版本，更新功能',
                '更换显示屏，重新安装驱动',
                '更换开关按钮，测试操作',
                '重新密封设备，进行防水测试',
                '清理散热系统，更换风扇'
            ];
            return solutions[Math.floor(Math.random() * solutions.length)];
        }

        // 生成维护材料
        function generateMaintenanceMaterials() {
            const materials = ['传感器', '电源模块', '连接线', '螺丝', '润滑油', '显示屏', '开关', '密封胶', '散热风扇', '软件升级包'];
            const usedMaterials = [];
            
            // 随机选择1-3种材料
            const materialCount = Math.floor(Math.random() * 3) + 1;
            for (let i = 0; i < materialCount; i++) {
                const material = materials[Math.floor(Math.random() * materials.length)];
                const quantity = Math.floor(Math.random() * 5) + 1;
                usedMaterials.push(`${material} × ${quantity}`);
            }
            
            return usedMaterials;
        }

        // 渲染维护记录
        function renderMaintenanceRecords(data) {
            const container = document.getElementById('maintenance-records-list');
            if (!container) return;

            let html = '';
            data.forEach(item => {
                html += `
                    <div class="record-item" data-record-id="${item.id}">
                        <div class="record-header">
                            <h5>${item.id} - ${item.equipmentName}</h5>
                            <span class="record-result ${item.result === '成功' ? 'result-success' : item.result === '部分成功' ? 'result-partial' : 'result-failed'}">${item.result}</span>
                        </div>
                        <div class="record-content">
                            <div class="record-info">
                                <div class="info-item">
                                    <span class="info-label">设备类型:</span>
                                    <span class="info-value">${item.equipmentType}</span>
                                </div>
                                <div class="info-item">
                                    <span class="info-label">维护类型:</span>
                                    <span class="info-value">${item.maintenanceType}</span>
                                </div>
                                <div class="info-item">
                                    <span class="info-label">执行日期:</span>
                                    <span class="info-value">${item.executionDate}</span>
                                </div>
                                <div class="info-item">
                                    <span class="info-label">负责人:</span>
                                    <span class="info-value">${item.responsiblePerson}</span>
                                </div>
                                <div class="info-item">
                                    <span class="info-label">持续时间:</span>
                                    <span class="info-value">${item.duration}</span>
                                </div>
                                <div class="info-item">
                                    <span class="info-label">维护成本:</span>
                                    <span class="info-value">¥${item.cost}</span>
                                </div>
                                <div class="info-item full-width">
                                    <span class="info-label">问题描述:</span>
                                    <span class="info-value">${item.issue}</span>
                                </div>
                                <div class="info-item full-width">
                                    <span class="info-label">解决方案:</span>
                                    <span class="info-value">${item.solution}</span>
                                </div>
                                <div class="info-item full-width">
                                    <span class="info-label">使用材料:</span>
                                    <span class="info-value">${item.materials.join(', ')}</span>
                                </div>
                            </div>
                            <div class="record-actions">
                                <button class="action-btn view-detail-btn" data-record-id="${item.id}">查看详情</button>
                                <button class="action-btn print-btn" data-record-id="${item.id}">打印记录</button>
                            </div>
                        </div>
                    </div>
                `;
            });
            container.innerHTML = html;
            
            // 添加维护记录操作事件
            addRecordActionEvents(data);
        }

        // 添加维护记录操作事件
        function addRecordActionEvents(records) {
            const viewDetailBtns = document.querySelectorAll('.record-item .view-detail-btn');
            const printBtns = document.querySelectorAll('.record-item .print-btn');
            
            // 查看记录详情
            viewDetailBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    const recordId = this.getAttribute('data-record-id');
                    const record = records.find(r => r.id === recordId);
                    if (record) {
                        showMaintenanceRecordDetail(record);
                    }
                });
            });
            
            // 打印记录
            printBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    const recordId = this.getAttribute('data-record-id');
                    const record = records.find(r => r.id === recordId);
                    if (record) {
                        printMaintenanceRecord(record);
                    }
                });
            });
        }

        // 显示维护记录详情
        function showMaintenanceRecordDetail(record) {
            let detailHtml = `
                <div class="record-detail-modal">
                    <h4>维护记录详情</h4>
                    <div class="detail-container">
                        <div class="detail-section">
                            <h5>基本信息</h5>
                            <div class="detail-info">
                                <div class="info-item">记录ID: ${record.id}</div>
                                <div class="info-item">设备名称: ${record.equipmentName}</div>
                                <div class="info-item">设备类型: ${record.equipmentType}</div>
                                <div class="info-item">维护类型: ${record.maintenanceType}</div>
                            </div>
                        </div>
                        <div class="detail-section">
                            <h5>执行信息</h5>
                            <div class="detail-info">
                                <div class="info-item">执行日期: ${record.executionDate}</div>
                                <div class="info-item">负责人: ${record.responsiblePerson}</div>
                                <div class="info-item">持续时间: ${record.duration}</div>
                                <div class="info-item">维护结果: <span class="result-tag ${record.result === '成功' ? 'result-success' : record.result === '部分成功' ? 'result-partial' : 'result-failed'}">${record.result}</span></div>
                            </div>
                        </div>
                        <div class="detail-section">
                            <h5>维护详情</h5>
                            <div class="detail-info">
                                <div class="info-item">问题描述: ${record.issue}</div>
                                <div class="info-item">解决方案: ${record.solution}</div>
                                <div class="info-item">使用材料: ${record.materials.join(', ')}</div>
                                <div class="info-item">维护成本: ¥${record.cost}</div>
                            </div>
                        </div>
                        <div class="detail-actions">
                            <button class="action-btn close-btn">关闭</button>
                            <button class="action-btn print-btn">打印记录</button>
                        </div>
                    </div>
                </div>
            `;
            
            // 创建模态框
            const modal = document.createElement('div');
            modal.className = 'maintenance-modal';
            modal.innerHTML = detailHtml;
            document.body.appendChild(modal);
            
            // 关闭模态框
            const closeBtn = modal.querySelector('.close-btn');
            closeBtn.addEventListener('click', function() {
                document.body.removeChild(modal);
            });
            
            // 打印记录
            const printBtn = modal.querySelector('.print-btn');
            printBtn.addEventListener('click', function() {
                printMaintenanceRecord(record);
            });
        }

        // 打印维护记录
        function printMaintenanceRecord(record) {
            // 创建打印内容
            let printContent = `
                <div class="print-record">
                    <h2>维护记录</h2>
                    <div class="print-info">
                        <div><strong>记录ID:</strong> ${record.id}</div>
                        <div><strong>设备名称:</strong> ${record.equipmentName}</div>
                        <div><strong>设备类型:</strong> ${record.equipmentType}</div>
                        <div><strong>维护类型:</strong> ${record.maintenanceType}</div>
                        <div><strong>执行日期:</strong> ${record.executionDate}</div>
                        <div><strong>负责人:</strong> ${record.responsiblePerson}</div>
                        <div><strong>持续时间:</strong> ${record.duration}</div>
                        <div><strong>维护结果:</strong> ${record.result}</div>
                        <div><strong>问题描述:</strong> ${record.issue}</div>
                        <div><strong>解决方案:</strong> ${record.solution}</div>
                        <div><strong>使用材料:</strong> ${record.materials.join(', ')}</div>
                        <div><strong>维护成本:</strong> ¥${record.cost}</div>
                    </div>
                </div>
            `;
        }

        // ------------------------------
        // 公共服务模块
        // ------------------------------
        function initPublicServiceModule() {
            // 初始化公共服务统计数据
            updatePublicServiceMetrics();
            
            // 添加服务卡片点击事件
            const serviceCards = document.querySelectorAll('[data-service]');
            serviceCards.forEach(card => {
                card.addEventListener('click', function() {
                    const serviceType = this.dataset.service;
                    showServiceDetail(serviceType);
                });
            });

            // 添加功能按钮事件
            const actionBtns = document.querySelectorAll('.public-service-section .action-btn');
            actionBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    const btnText = this.textContent;
                    handleServiceAction(btnText);
                });
            });
        }

        // 更新公共服务统计数据
        function updatePublicServiceMetrics() {
            const metricsData = {
                'service-points': { '办事网点': { min: 80, max: 100 }, '办事指南': { min: 120, max: 150 } },
                'bicycle-stations': { '租赁站点': { min: 40, max: 50 }, '自行车数': { min: 800, max: 1000 } },
                'user-points': { '积分用户': { min: 5000, max: 6000 }, '兑换奖品': { min: 10, max: 20 } },
                'user-reports': { '本月爆料': { min: 200, max: 300 }, '处理率': { min: 90, max: 98 } },
                'station-management': { '便民驿站': { min: 15, max: 25 }, '月访问量': { min: 1000, max: 1500 } },
                'news-management': { '新闻资讯': { min: 60, max: 80 }, '本月发布': { min: 10, max: 20 } },
                'water-logging': { '积水监测点': { min: 30, max: 40 }, '当前预警': { min: 0, max: 10 } },
                'policies': { '政策文件': { min: 40, max: 50 }, '法规条例': { min: 10, max: 15 } },
                'report-templates': { '爆料类型': { min: 5, max: 10 }, '使用率': { min: 90, max: 100 } },
                'toilet-management': { '公共厕所': { min: 60, max: 80 }, '清洁率': { min: 85, max: 95 } },
                'daily-question': { '题目总数': { min: 200, max: 300 }, '今日参与': { min: 100, max: 200 } },
                'statistics': { '高发区域': { min: 10, max: 20 }, '活跃用户': { min: 20, max: 30 } }
            };

            // 更新各个服务卡片的统计数据
            Object.keys(metricsData).forEach(serviceKey => {
                const card = document.querySelector(`[data-service="${serviceKey}"]`);
                if (card) {
                    const stats = card.querySelectorAll('.stat-item');
                    const statConfig = metricsData[serviceKey];
                    let index = 0;
                    
                    Object.keys(statConfig).forEach(statName => {
                        if (index < stats.length - 1) { // 最后一个统计项是APP支持，不需要更新
                            const statItem = stats[index];
                            const statValue = statItem.querySelector('.stat-value');
                            const config = statConfig[statName];
                            
                            if (statValue && config) {
                                let newValue;
                                if (statName.includes('率') || statName.includes('清洁率')) {
                                    newValue = (Math.random() * (config.max - config.min) + config.min).toFixed(1) + '%';
                                } else {
                                    newValue = Math.floor(Math.random() * (config.max - config.min + 1)) + config.min;
                                    newValue = newValue.toLocaleString();
                                }
                                statValue.textContent = newValue;
                            }
                            index++;
                        }
                    });
                }
            });
        }

        // 显示服务详情
        function showServiceDetail(serviceType) {
            const serviceNames = {
                'service-points': '办事网点、指南',
                'bicycle-stations': '自行车租赁站点',
                'user-points': '用户积分',
                'user-reports': '用户爆料',
                'station-management': '驿站管理',
                'news-management': '新闻管理',
                'water-logging': '道路积水点',
                'policies': '政策法规',
                'report-templates': '爆料模板',
                'toilet-management': '公厕管理',
                'daily-question': '每日一题',
                'statistics': '统计'
            };

            const serviceName = serviceNames[serviceType] || '公共服务';
            alert(`正在进入${serviceName}管理界面...`);
        }

        // 处理服务操作
        function handleServiceAction(actionText) {
            alert(`正在执行${actionText}操作...`);
        }

        // 每30秒更新一次公共服务数据
        setInterval(updatePublicServiceMetrics, 30000);

        // ------------------------------
        // 事件处理模块
        // ------------------------------
        function initIncidentModule() {
            // 生成待处理事件数据
            const allIncidents = generatePendingIncidents(15);
            
            // 过滤出待处理事件（排除已忽略、已结案、已转案件）
            const pendingIncidents = allIncidents.filter(item => 
                ['待上报', '待派遣', '待核查', '待处置', '待结案'].includes(item.status)
            );
            renderPendingIncidents(pendingIncidents);
            
            // 更新事件流程统计
            updateIncidentFlowStats(allIncidents);

            // 添加事件点击事件
            const eventList = document.getElementById('pending-incidents');
            const incidentDetail = document.getElementById('incident-detail-content');

            if (eventList && incidentDetail) {
                eventList.addEventListener('click', function(e) {
                    const eventItem = e.target.closest('.event-item');
                    if (eventItem) {
                        const incidentId = eventItem.dataset.incidentId;
                        const incident = allIncidents.find(item => item.id === incidentId);
                        if (incident) {
                            renderIncidentDetail(incident, incidentDetail, allIncidents);
                        }
                    }
                });
            }
        }

        // 生成待处理事件数据
        function generatePendingIncidents(count) {
            const incidentTypes = ['交通拥堵', '垃圾满溢', '井盖异常', '路灯故障', '排水堵塞', '违章停车', '占道经营', '绿化损坏'];
            const locations = ['XX大道与XX路交叉口', 'XX公园北门', 'XX小区东门', 'XX商圈周边', 'XX隧道出口', 'XX火车站广场', 'XX医院门口'];
            const statuses = ['待上报', '待派遣', '待核查', '待处置', '待结案', '已忽略', '已结案', '已转案件'];
            const data = [];

            for (let i = 0; i < count; i++) {
                const date = new Date();
                date.setMinutes(date.getMinutes() - Math.floor(Math.random() * 120));
                
                const incident = {
                    id: 'INC' + String(i + 3001).padStart(4, '0'),
                    type: incidentTypes[Math.floor(Math.random() * incidentTypes.length)],
                    location: locations[Math.floor(Math.random() * locations.length)],
                    time: date.toISOString().slice(0, 16).replace('T', ' '),
                    status: statuses[Math.floor(Math.random() * statuses.length)],
                    description: `${incidentTypes[Math.floor(Math.random() * incidentTypes.length)]}，需要及时处理以避免影响市民生活。`,
                    priority: Math.random() > 0.5 ? '高' : Math.random() > 0.5 ? '中' : '低',
                    reporter: `市民${Math.floor(Math.random() * 1000 + 1)}`,
                    handler: '',
                    handleResult: '',
                    history: [
                        {
                            action: '创建',
                            time: date.toISOString().slice(0, 16).replace('T', ' '),
                            user: '系统',
                            description: '事件创建'
                        }
                    ]
                };
                
                // 为不同状态添加额外信息
                if (incident.status !== '待上报') {
                    incident.reporter = `网格员${Math.floor(Math.random() * 100 + 1)}`;
                    incident.history.push({
                        action: '上报',
                        time: new Date(date.getTime() + Math.random() * 3600000).toISOString().slice(0, 16).replace('T', ' '),
                        user: incident.reporter,
                        description: '事件上报'
                    });
                }
                
                if (incident.status === '待派遣' || incident.status === '待核查' || incident.status === '待处置' || incident.status === '待结案' || incident.status === '已结案' || incident.status === '已转案件') {
                    incident.handler = `处置员${Math.floor(Math.random() * 50 + 1)}`;
                    incident.history.push({
                        action: '派遣',
                        time: new Date(date.getTime() + Math.random() * 7200000).toISOString().slice(0, 16).replace('T', ' '),
                        user: `调度员${Math.floor(Math.random() * 20 + 1)}`,
                        description: `派遣给${incident.handler}`
                    });
                }
                
                if (incident.status === '待核查' || incident.status === '待处置' || incident.status === '待结案' || incident.status === '已结案' || incident.status === '已转案件') {
                    incident.history.push({
                        action: '核查',
                        time: new Date(date.getTime() + Math.random() * 10800000).toISOString().slice(0, 16).replace('T', ' '),
                        user: incident.handler,
                        description: '事件核查通过'
                    });
                }
                
                if (incident.status === '已忽略') {
                    incident.history.push({
                        action: '忽略',
                        time: new Date(date.getTime() + Math.random() * 3600000).toISOString().slice(0, 16).replace('T', ' '),
                        user: `调度员${Math.floor(Math.random() * 20 + 1)}`,
                        description: '事件不属于城管职责范围'
                    });
                }
                
                if (incident.status === '已结案') {
                    incident.handleResult = '事件已处理完成，道路恢复正常通行';
                    incident.history.push({
                        action: '处置',
                        time: new Date(date.getTime() + Math.random() * 14400000).toISOString().slice(0, 16).replace('T', ' '),
                        user: incident.handler,
                        description: incident.handleResult
                    });
                    incident.history.push({
                        action: '结案',
                        time: new Date(date.getTime() + Math.random() * 18000000).toISOString().slice(0, 16).replace('T', ' '),
                        user: `质检员${Math.floor(Math.random() * 10 + 1)}`,
                        description: '事件处置合格，结案'
                    });
                }
                
                if (incident.status === '已转案件') {
                    incident.history.push({
                        action: '转案件',
                        time: new Date(date.getTime() + Math.random() * 10800000).toISOString().slice(0, 16).replace('T', ' '),
                        user: `调度员${Math.floor(Math.random() * 20 + 1)}`,
                        description: '事件性质严重，转至执法部门处理'
                    });
                }
                
                data.push(incident);
            }

            return data;
        }

        // 渲染待处理事件
        function renderPendingIncidents(data) {
            const container = document.getElementById('pending-incidents');
            if (!container) return;

            let html = '';
            data.forEach(item => {
                // 根据状态计算剩余处理时间
                const statusConfig = {
                    '待上报': { color: '#95a5a6', text: '待上报' },
                    '待派遣': { color: '#3498db', text: '待派遣' },
                    '待核查': { color: '#f39c12', text: '待核查' },
                    '待处置': { color: '#e74c3c', text: '待处置' },
                    '待结案': { color: '#27ae60', text: '待结案' }
                };
                
                const statusInfo = statusConfig[item.status] || { color: '#95a5a6', text: item.status };
                const priorityColor = item.priority === '高' ? '#e74c3c' : item.priority === '中' ? '#f39c12' : '#27ae60';
                
                html += `
                    <div class="event-item" data-incident-id="${item.id}" style="padding: 15px; margin-bottom: 10px; background: #f9fafb; border-radius: 8px; border-left: 3px solid ${priorityColor}; cursor: pointer; transition: all 0.3s ease;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                            <h5 style="margin: 0;">${item.id} - ${item.type}</h5>
                            <div style="display: flex; gap: 8px;">
                                <span style="padding: 3px 8px; border-radius: 12px; font-size: 0.8em; background: ${statusInfo.color}; color: white;">${statusInfo.text}</span>
                                <span style="padding: 3px 8px; border-radius: 12px; font-size: 0.8em; background: ${priorityColor}; color: white;">${item.priority}</span>
                            </div>
                        </div>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; font-size: 0.9em;">
                            <div>位置: ${item.location}</div>
                            <div>时间: ${item.time}</div>
                            <div>上报人: ${item.reporter || '未上报'}</div>
                            <div>处理人: ${item.handler || '未指派'}</div>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }

        // 渲染事件详情
        function renderIncidentDetail(incident, container, allIncidents) {
            container.innerHTML = `
                <div style="padding: 20px; background: #f9fafb; border-radius: 8px;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                        <h4 style="margin: 0;">${incident.id} - ${incident.type}</h4>
                        <div style="display: flex; gap: 10px;">
                            <span style="padding: 5px 12px; border-radius: 12px; font-size: 0.9em; background-color: ${incident.priority === '高' ? '#e74c3c' : incident.priority === '中' ? '#f39c12' : '#27ae60'}; color: white;">${incident.priority}优先级</span>
                            <span style="padding: 5px 12px; border-radius: 12px; font-size: 0.9em; background-color: ${getStatusColor(incident.status)}; color: white;">${incident.status}</span>
                        </div>
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 20px;">
                        <div>
                            <strong>位置:</strong> ${incident.location}
                        </div>
                        <div>
                            <strong>创建时间:</strong> ${incident.time}
                        </div>
                        <div>
                            <strong>上报人:</strong> ${incident.reporter || '未上报'}
                        </div>
                        <div>
                            <strong>处理人:</strong> ${incident.handler || '未指派'}
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;">
                        <strong>事件描述:</strong>
                        <p style="margin-top: 5px; line-height: 1.6; background: white; padding: 15px; border-radius: 6px;">${incident.description}</p>
                    </div>
                    ${incident.handleResult ? `
                        <div style="margin-bottom: 20px;">
                            <strong>处理结果:</strong>
                            <p style="margin-top: 5px; line-height: 1.6; background: white; padding: 15px; border-radius: 6px; border-left: 3px solid #27ae60;">${incident.handleResult}</p>
                        </div>
                    ` : ''}
                    
                    <div style="margin-bottom: 25px;">
                        <strong>处理历史:</strong>
                        <div style="margin-top: 10px; background: white; border-radius: 6px; padding: 15px; max-height: 200px; overflow-y: auto;">
                            ${incident.history.map(record => `
                                <div style="padding: 10px 0; border-bottom: 1px solid #f0f0f0; display: grid; grid-template-columns: 1fr 2fr 1fr 2fr; gap: 10px; font-size: 0.9em;">
                                    <span style="font-weight: bold; color: #667eea;">${record.action}</span>
                                    <span>${record.description}</span>
                                    <span style="color: #7f8c8d;">${record.user}</span>
                                    <span style="color: #7f8c8d; text-align: right;">${record.time}</span>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                    
                    <div style="display: flex; gap: 10px; flex-wrap: wrap;" id="incident-actions">
                        ${renderActionButtons(incident)}
                    </div>
                </div>
            `;

            // 添加事件处理按钮事件
            const actionBtns = container.querySelectorAll('.action-btn');
            actionBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    const action = this.dataset.action;
                    const incidentId = this.dataset.incidentId;
                    handleIncidentAction(action, incidentId, allIncidents);
                });
            });
        }

        // 渲染事件处理按钮（根据当前状态动态显示）
        function renderActionButtons(incident) {
            const status = incident.status;
            const id = incident.id;
            const buttons = [];
            
            // 定义每个状态可执行的操作
            const actionConfig = {
                '待上报': [
                    { action: 'report', text: '立即上报', color: '#3498db' },
                    { action: 'ignore', text: '忽略事件', color: '#95a5a6' }
                ],
                '待派遣': [
                    { action: 'dispatch', text: '派遣核查', color: '#f39c12' },
                    { action: 'ignore', text: '忽略事件', color: '#95a5a6' }
                ],
                '待核查': [
                    { action: 'verify', text: '核查通过', color: '#27ae60' },
                    { action: 'ignore', text: '核查不通过', color: '#e74c3c' }
                ],
                '待处置': [
                    { action: 'dispose', text: '处置完成', color: '#2980b9' },
                    { action: 'transfer', text: '转案件', color: '#8e44ad' }
                ],
                '待结案': [
                    { action: 'close', text: '结案处理', color: '#27ae60' },
                    { action: 'transfer', text: '转案件', color: '#8e44ad' }
                ],
                '已忽略': [
                    { action: 'report', text: '重新上报', color: '#3498db' }
                ],
                '已结案': [
                    { action: 'history', text: '查看详情', color: '#555' }
                ],
                '已转案件': [
                    { action: 'history', text: '查看详情', color: '#555' }
                ]
            };
            
            // 获取当前状态的可用操作
            const availableActions = actionConfig[status] || [];
            
            // 渲染按钮
            availableActions.forEach(btn => {
                // 确保按钮有颜色，使用默认颜色作为 fallback
                const buttonColor = btn.color || '#667eea';
                buttons.push(`
                    <button class="action-btn" data-action="${btn.action}" data-incident-id="${id}" 
                    style="padding: 8px 16px; background-color: ${buttonColor}; color: white; border: none; 
                    border-radius: 5px; cursor: pointer; transition: background-color 0.3s ease;">
                    ${btn.text}</button>
                `);
            });
            
            // 始终显示查看历史按钮
            buttons.push(`
                <button class="action-btn" data-action="history" data-incident-id="${id}" style="padding: 8px 16px; background-color: #666; color: white; border: none; border-radius: 5px; cursor: pointer; transition: background-color 0.3s ease;">查看历史</button>
            `);
            
            return buttons.join('');
        }

        // 获取状态颜色
        function getStatusColor(status) {
            const statusColors = {
                '待上报': '#95a5a6',
                '待派遣': '#3498db',
                '待核查': '#f39c12',
                '待处置': '#e74c3c',
                '待结案': '#27ae60',
                '已忽略': '#95a5a6',
                '已结案': '#27ae60',
                '已转案件': '#8e44ad'
            };
            return statusColors[status] || '#95a5a6';
        }

        // 更新事件流程统计
        function updateIncidentFlowStats(allIncidents) {
            // 统计各状态事件数量
            const stats = {
                '待上报': 0,
                '待派遣': 0,
                '待核查': 0,
                '待处置': 0,
                '已忽略': 0,
                '已结案': 0,
                '已转案件': 0
            };
            
            allIncidents.forEach(incident => {
                if (stats.hasOwnProperty(incident.status)) {
                    stats[incident.status]++;
                }
            });
            
            // 更新流程步骤的统计数字
            const steps = document.querySelectorAll('.flow-step');
            steps.forEach(step => {
                const name = step.querySelector('.step-name').textContent;
                let count = 0;
                
                switch(name) {
                    case '事件上报':
                        count = stats['待上报'];
                        break;
                    case '事件派遣':
                        count = stats['待派遣'];
                        break;
                    case '事件核查':
                        count = stats['待核查'];
                        break;
                    case '忽略/处置':
                        count = stats['待处置'] + stats['已忽略'];
                        break;
                    case '结案/转案件':
                        count = stats['已结案'] + stats['已转案件'];
                        break;
                }
                
                const countElement = step.querySelector('.step-count');
                if (countElement) {
                    countElement.textContent = count;
                }
            });
        }

        // 处理事件操作
        function handleIncidentAction(action, incidentId, allIncidents) {
            const incident = allIncidents.find(item => item.id === incidentId);
            if (!incident) return;

            const now = new Date().toISOString().slice(0, 16).replace('T', ' ');
            let newStatus = incident.status;
            let message = '';
            let historyAction = '';
            let historyDesc = '';
            
            // 定义状态流转逻辑
            switch(action) {
                case 'report':
                    newStatus = '待派遣';
                    message = '事件已成功上报';
                    historyAction = '上报';
                    historyDesc = '事件上报成功';
                    // 如果是从已忽略状态重新上报，重置一些信息
                    if (incident.status === '已忽略') {
                        incident.handler = '';
                        incident.handleResult = '';
                    }
                    // 设置上报人
                    if (!incident.reporter) {
                        incident.reporter = `网格员${Math.floor(Math.random() * 100 + 1)}`;
                    }
                    break;
                    
                case 'dispatch':
                    newStatus = '待核查';
                    message = '事件已派遣核查人员';
                    historyAction = '派遣';
                    // 设置处理人
                    incident.handler = incident.handler || `处置员${Math.floor(Math.random() * 50 + 1)}`;
                    historyDesc = `派遣给${incident.handler}`;
                    break;
                    
                case 'verify':
                    newStatus = '待处置';
                    message = '事件核查通过，进入处置阶段';
                    historyAction = '核查';
                    historyDesc = '事件核查通过';
                    break;
                    
                case 'ignore':
                    newStatus = '已忽略';
                    message = '事件已忽略';
                    historyAction = '忽略';
                    historyDesc = '事件被忽略';
                    break;
                    
                case 'dispose':
                    newStatus = '待结案';
                    message = '事件已处置完成，等待结案';
                    historyAction = '处置';
                    // 设置处置结果
                    incident.handleResult = `${incident.type}事件已处理完成，恢复正常状态`;
                    historyDesc = incident.handleResult;
                    break;
                    
                case 'close':
                    newStatus = '已结案';
                    message = '事件已成功结案';
                    historyAction = '结案';
                    historyDesc = '事件处置合格，结案';
                    break;
                    
                case 'transfer':
                    newStatus = '已转案件';
                    message = '事件已转至相关部门处理';
                    historyAction = '转案件';
                    historyDesc = '事件性质严重，转至执法部门处理';
                    break;
                    
                case 'history':
                    // 查看历史已在renderIncidentDetail中处理
                    return;
            }

            // 更新事件状态
            incident.status = newStatus;
            
            // 记录处理历史
            if (!incident.history) {
                incident.history = [];
            }
            
            incident.history.push({
                action: historyAction,
                time: now,
                user: '当前用户',
                description: historyDesc
            });
            
            // 重新渲染待处理事件列表
            const pendingIncidents = allIncidents.filter(item => 
                ['待上报', '待派遣', '待核查', '待处置', '待结案'].includes(item.status)
            );
            renderPendingIncidents(pendingIncidents);

            // 更新事件详情
            const incidentDetail = document.getElementById('incident-detail-content');
            if (incidentDetail) {
                renderIncidentDetail(incident, incidentDetail, allIncidents);
            }
            
            // 更新事件流程统计
            updateIncidentFlowStats(allIncidents);

            alert(message);
        }

        // ------------------------------
        // 决策分析模块
        // ------------------------------
        function initDecisionModule() {
            // 初始化防汛防洪监控
            initFloodControlMonitoring();
        }

        // 初始化防汛防洪监控
        function initFloodControlMonitoring() {
            // 模拟实时水位变化
            const floodMetrics = document.querySelector('.flood-metrics');
            if (!floodMetrics) return;

            setInterval(() => {
                const currentWaterLevel = floodMetrics.querySelector('.metric-value');
                if (currentWaterLevel) {
                    // 随机生成水位变化（在70%-80%之间）
                    const newLevel = (70 + Math.random() * 10).toFixed(1);
                    currentWaterLevel.textContent = newLevel + '%';
                    
                    // 检查是否需要预警
                    if (parseFloat(newLevel) > 85) {
                        alert('⚠️ 防汛预警：当前水位已超过85%警戒值，请立即采取措施！');
                    }
                }
            }, 5000); // 每5秒更新一次
        }

        // ------------------------------
        // 事件汇总模块
        // ------------------------------
        function initSummaryModule() {
            // 生成事件统计数据
            const summaryData = generateSummaryStats();
            renderSummaryStats(summaryData);
            // 渲染优先级分布数据
            renderPriorityDistribution(summaryData);
        }

        // 生成事件统计数据
        function generateSummaryStats() {
            const incidentTypes = ['交通拥堵', '垃圾满溢', '井盖异常', '路灯故障', '排水堵塞', '违章停车', 
                                 '占道经营', '绿化损坏', '公共设施损坏', '广告乱贴', '流浪动物', '噪音扰民'];
            const data = [];

            incidentTypes.forEach(type => {
                const total = Math.floor(Math.random() * 150) + 30;
                const solved = Math.floor(total * (0.7 + Math.random() * 0.3));
                const solveRate = ((solved / total) * 100).toFixed(1);
                const avgDuration = (Math.random() * 4 + 0.5).toFixed(1);
                // 新增：按部门分类
                const departments = ['交通管理', '环卫清洁', '市政维护', '排水管理', '照明管理', '综合执法'];
                const department = departments[Math.floor(Math.random() * departments.length)];
                // 新增：按区域分类
                const regions = ['东区', '南区', '西区', '北区', '中心区'];
                const region = regions[Math.floor(Math.random() * regions.length)];
                // 新增：优先级分布
                const priorityDistribution = {
                    high: Math.floor(total * (0.2 + Math.random() * 0.2)),
                    medium: Math.floor(total * (0.3 + Math.random() * 0.2)),
                    low: Math.floor(total * (0.3 + Math.random() * 0.2))
                };

                data.push({
                    type: type,
                    total: total,
                    solved: solved,
                    solveRate: solveRate,
                    avgDuration: avgDuration,
                    department: department,
                    region: region,
                    priorityDistribution: priorityDistribution
                });
            });

            return data;
        }

        // 渲染事件统计数据
        function renderSummaryStats(data) {
            const tbody = document.getElementById('summary-stats-body');
            if (!tbody) return;

            let html = '';
            data.forEach(item => {
                html += `
                    <tr>
                        <td>${item.type}</td>
                        <td>${item.total}</td>
                        <td>${item.solved}</td>
                        <td>${item.solveRate}%</td>
                        <td>${item.avgDuration}小时</td>
                        <td>${item.department}</td>
                    </tr>
                `;
            });
            tbody.innerHTML = html;
        }

        // 渲染事件优先级分布数据
        function renderPriorityDistribution(data) {
            const tbody = document.getElementById('priority-distribution-body');
            if (!tbody) return;

            let html = '';
            data.forEach(item => {
                html += `
                    <tr>
                        <td>${item.type}</td>
                        <td>${item.priorityDistribution.high}</td>
                        <td>${item.priorityDistribution.medium}</td>
                        <td>${item.priorityDistribution.low}</td>
                        <td>${item.region}</td>
                    </tr>
                `;
            });
            tbody.innerHTML = html;
        }
    </script>
</body>
</html></div><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="giscus-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src= "/img/20241215205335173426721579192.webp" data-lazy-src="/img/butterfly-icon.webp" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">余一叶知秋尽</div><div class="author-info-description">Java、Linux、DB、MQ、IOT、AI、架构、大数据、算法等技术分享</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">52</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">236</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">41</div></a></div><a id="card-info-btn" href="https://github.com/hengline"><i class="fab fa-github"></i><span>GitHub</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://leetcode.cn/u/pengline" target="_blank" title="Leetcode"><i class="iconfont icon-leetcode1" style="color: #422123;"></i></a><a class="social-icon" href="https://github.com/hengline" target="_blank" title="GitHub"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:haeng2030@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content"><li>文章持续更新中，有任何建议或意见，可发邮件、评论、留言，看到后会及时回复。</li> <li><b>AI栏目</b>：AIGC、Agent系统正在开发中，目前只展示部分静态页面，服务端功能尚未部署，敬请期待....</li> <li><b>工具栏目</b>：若需要更多拓展功能，或有新工具需求，可随时提出，当竭尽所能实现，以供免费使用。</li> <li><b>暖心提示</b>：夜晚时分可在<b>右下角⚙️</b>中点击<b>🌙</b>，切换“深色模式”，以防护眼睛。</li></div></div><div class="sticky_layout"><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/12/d19b9918fb0b4c88b7f585fa60506dc8/" title="JPA save() 的性能影响和潜在风险分析"><img src= "/img/20241215205335173426721579192.webp" data-lazy-src="/img/essay/1634204644701163420464439.webp" onerror="this.onerror=null;this.src='/img/k3zssqvjw2d.jpg'" alt="JPA save() 的性能影响和潜在风险分析"/></a><div class="content"><a class="title" href="/2025/12/d19b9918fb0b4c88b7f585fa60506dc8/" title="JPA save() 的性能影响和潜在风险分析">JPA save() 的性能影响和潜在风险分析</a><time datetime="2025-12-23T16:00:00.000Z" title="发表于 2025-12-24 00:00:00">2025-12-24</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/12/993e8895ae2e46ca8c4d744b312d1491/" title="ES 手动路由和自动路由的实现过程"><img src= "/img/20241215205335173426721579192.webp" data-lazy-src="/img/essay/1753692691876175369269194.webp" onerror="this.onerror=null;this.src='/img/k3zssqvjw2d.jpg'" alt="ES 手动路由和自动路由的实现过程"/></a><div class="content"><a class="title" href="/2025/12/993e8895ae2e46ca8c4d744b312d1491/" title="ES 手动路由和自动路由的实现过程">ES 手动路由和自动路由的实现过程</a><time datetime="2025-12-19T16:00:00.000Z" title="发表于 2025-12-20 00:00:00">2025-12-20</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/12/27fc28876c1e4f9baacd88ca8f29b266/" title="Mysql 各种索引详解和使用指南"><img src= "/img/20241215205335173426721579192.webp" data-lazy-src="/img/essay/1745746446968174574644625.webp" onerror="this.onerror=null;this.src='/img/k3zssqvjw2d.jpg'" alt="Mysql 各种索引详解和使用指南"/></a><div class="content"><a class="title" href="/2025/12/27fc28876c1e4f9baacd88ca8f29b266/" title="Mysql 各种索引详解和使用指南">Mysql 各种索引详解和使用指南</a><time datetime="2025-12-06T16:00:00.000Z" title="发表于 2025-12-07 00:00:00">2025-12-07</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/12/c48cd69e7a3b47faae3866edeb761422/" title="同步 Mysql 数据的多种方式和策略"><img src= "/img/20241215205335173426721579192.webp" data-lazy-src="/img/essay/small102614pbz4m1758680774.webp" onerror="this.onerror=null;this.src='/img/k3zssqvjw2d.jpg'" alt="同步 Mysql 数据的多种方式和策略"/></a><div class="content"><a class="title" href="/2025/12/c48cd69e7a3b47faae3866edeb761422/" title="同步 Mysql 数据的多种方式和策略">同步 Mysql 数据的多种方式和策略</a><time datetime="2025-12-02T16:00:00.000Z" title="发表于 2025-12-03 00:00:00">2025-12-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/11/bbd3588b364c411b9d216db736b34a97/" title="JVM 几种常用垃圾收集器的比较"><img src= "/img/20241215205335173426721579192.webp" data-lazy-src="/img/essay/small221427alvR01759155267.webp" onerror="this.onerror=null;this.src='/img/k3zssqvjw2d.jpg'" alt="JVM 几种常用垃圾收集器的比较"/></a><div class="content"><a class="title" href="/2025/11/bbd3588b364c411b9d216db736b34a97/" title="JVM 几种常用垃圾收集器的比较">JVM 几种常用垃圾收集器的比较</a><time datetime="2025-11-28T16:00:00.000Z" title="发表于 2025-11-29 00:00:00">2025-11-29</time></div></div></div></div><div class="card-widget card-categories"><div class="item-headline">
            <i class="fas fa-folder-open"></i>
            <span>分类</span>
            <a class="card-more-btn" href="/categories/" title="查看更多">
      <i class="fas fa-angle-right"></i></a>
          </div>
          <ul class="card-category-list expandBtn" id="aside-cat-list">
            <li class="card-category-list-item parent"><a class="card-category-list-link" href="/categories/AI/"><span class="card-category-list-name">AI</span><span class="card-category-list-count">4</span><i class="fas fa-caret-left "></i></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/AI/Agent/"><span class="card-category-list-name">Agent</span><span class="card-category-list-count">3</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/AI/Model/"><span class="card-category-list-name">Model</span><span class="card-category-list-count">1</span></a></li></ul></li><li class="card-category-list-item parent"><a class="card-category-list-link" href="/categories/DB/"><span class="card-category-list-name">DB</span><span class="card-category-list-count">12</span><i class="fas fa-caret-left "></i></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/DB/ES/"><span class="card-category-list-name">ES</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/DB/MVCC/"><span class="card-category-list-name">MVCC</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/DB/MySQL/"><span class="card-category-list-name">MySQL</span><span class="card-category-list-count">6</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/DB/Redis/"><span class="card-category-list-name">Redis</span><span class="card-category-list-count">2</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/DB/%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8/"><span class="card-category-list-name">分库分表</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/DB/%E6%B7%B1%E5%BA%A6%E5%88%86%E9%A1%B5/"><span class="card-category-list-name">深度分页</span><span class="card-category-list-count">1</span></a></li></ul></li><li class="card-category-list-item parent"><a class="card-category-list-link" href="/categories/DevOps/"><span class="card-category-list-name">DevOps</span><span class="card-category-list-count">3</span><i class="fas fa-caret-left "></i></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/DevOps/Centos/"><span class="card-category-list-name">Centos</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/DevOps/Docker/"><span class="card-category-list-name">Docker</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/DevOps/K8S/"><span class="card-category-list-name">K8S</span><span class="card-category-list-count">1</span></a></li></ul></li><li class="card-category-list-item parent"><a class="card-category-list-link" href="/categories/IOT/"><span class="card-category-list-name">IOT</span><span class="card-category-list-count">1</span><i class="fas fa-caret-left "></i></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/IOT/MQTT/"><span class="card-category-list-name">MQTT</span><span class="card-category-list-count">1</span></a></li></ul></li><li class="card-category-list-item parent"><a class="card-category-list-link" href="/categories/Java/"><span class="card-category-list-name">Java</span><span class="card-category-list-count">17</span><i class="fas fa-caret-left "></i></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Java/JPA/"><span class="card-category-list-name">JPA</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Java/JVM/"><span class="card-category-list-name">JVM</span><span class="card-category-list-count">3</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Java/OSGi/"><span class="card-category-list-name">OSGi</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Java/SPI/"><span class="card-category-list-name">SPI</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Java/%E5%88%86%E5%B8%83%E5%BC%8F/"><span class="card-category-list-name">分布式</span><span class="card-category-list-count">2</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Java/%E5%A4%9A%E7%BA%BF%E7%A8%8B/"><span class="card-category-list-name">多线程</span><span class="card-category-list-count">7</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Java/%E6%80%A7%E8%83%BD/"><span class="card-category-list-name">性能</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Java/%E8%A7%84%E5%88%99%E5%BC%95%E6%93%8E/"><span class="card-category-list-name">规则引擎</span><span class="card-category-list-count">1</span></a></li></ul></li><li class="card-category-list-item parent"><a class="card-category-list-link" href="/categories/MQ/"><span class="card-category-list-name">MQ</span><span class="card-category-list-count">3</span><i class="fas fa-caret-left "></i></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/MQ/RabbitMQ/"><span class="card-category-list-name">RabbitMQ</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/MQ/RocketMQ/"><span class="card-category-list-name">RocketMQ</span><span class="card-category-list-count">2</span></a></li></ul></li><li class="card-category-list-item parent"><a class="card-category-list-link" href="/categories/Python/"><span class="card-category-list-name">Python</span><span class="card-category-list-count">1</span><i class="fas fa-caret-left "></i></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Python/%E5%9B%9E%E8%B0%83%E5%87%BD%E6%95%B0/"><span class="card-category-list-name">回调函数</span><span class="card-category-list-count">1</span></a></li></ul></li>
          </ul></div><div class="card-widget card-archives">
    <div class="item-headline">
      <i class="fas fa-archive"></i>
      <span>归档</span>
      
    </div>
  
    <ul class="card-archive-list">
      
        <li class="card-archive-list-item">
          <a class="card-archive-list-link" href="/archives/2025/12/">
            <span class="card-archive-list-date">
              十二月 2025
            </span>
            <span class="card-archive-list-count">4</span>
          </a>
        </li>
      
        <li class="card-archive-list-item">
          <a class="card-archive-list-link" href="/archives/2025/11/">
            <span class="card-archive-list-date">
              十一月 2025
            </span>
            <span class="card-archive-list-count">7</span>
          </a>
        </li>
      
        <li class="card-archive-list-item">
          <a class="card-archive-list-link" href="/archives/2025/10/">
            <span class="card-archive-list-date">
              十月 2025
            </span>
            <span class="card-archive-list-count">15</span>
          </a>
        </li>
      
        <li class="card-archive-list-item">
          <a class="card-archive-list-link" href="/archives/2025/09/">
            <span class="card-archive-list-date">
              九月 2025
            </span>
            <span class="card-archive-list-count">18</span>
          </a>
        </li>
      
        <li class="card-archive-list-item">
          <a class="card-archive-list-link" href="/archives/2025/08/">
            <span class="card-archive-list-date">
              八月 2025
            </span>
            <span class="card-archive-list-count">8</span>
          </a>
        </li>
      
    </ul>
  </div><div class="card-widget card-webinfo"><div class="item-headline"><i class="fas fa-chart-line"></i><span>网站信息</span></div><div class="webinfo"><div class="webinfo-item"><div class="item-name">文章数目 :</div><div class="item-count">52</div></div><div class="webinfo-item"><div class="item-name">本站访客数 :</div><div class="item-count" id="busuanzi_value_site_uv"><i class="fa-solid fa-spinner fa-spin"></i></div></div><div class="webinfo-item"><div class="item-name">本站总浏览量 :</div><div class="item-count" id="busuanzi_value_site_pv"><i class="fa-solid fa-spinner fa-spin"></i></div></div><div class="webinfo-item"><div class="item-name">最后更新时间 :</div><div class="item-count" id="last-push-date" data-lastPushDate="2026-01-29T11:38:04.766Z"><i class="fa-solid fa-spinner fa-spin"></i></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2025 - 2026 By 余一叶知秋尽</span><span class="framework-info"><span>框架 </span><a href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>主题 </span><a href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.4.3</a></span></div><div class="footer_custom_text"><p><a style="margin-inline:5px"target="_blank"href="https://github.com/"><img src= "/img/20241215205335173426721579192.webp" data-lazy-src="https://img.shields.io/badge/Hosted-Github-brightgreen?style=flat&logo=GitHub"title="本站项目由Gtihub托管"></a><a style="margin-inline:5px"target="_blank"href="https://hexo.io/"><img src= "/img/20241215205335173426721579192.webp" data-lazy-src="https://img.shields.io/badge/Frame-Hexo-blue?style=flat&logo=hexo"title="博客框架为Hexo"></a><a style="margin-inline:5px"target="_blank"href="https://butterfly.js.org/"><img src= "/img/20241215205335173426721579192.webp" data-lazy-src="https://img.shields.io/badge/Theme-Butterfly-6513df?logoColor=white&style=flat&logo=buefy"title="主题采用butterfly"></a><a style="margin-inline:5px"target="_blank"href="https://giscus.app/zh-CN/"><img src= "/img/20241215205335173426721579192.webp" data-lazy-src="https://img.shields.io/badge/Comment-Giscus-2873df?logoColor=white&style=flat&logo=git"title="评论系统为Giscus"></a><a style="margin-inline:5px"target="_blank"href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img src= "/img/20241215205335173426721579192.webp" data-lazy-src="https://img.shields.io/badge/Copyright-BY--NC--SA%204.0-d42328?style=flat&logo=Claris"title="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可"></a></p></div><script src="https://unpkg.com/mermaid@11.5.0/dist/mermaid.min.js"></script><script>if (window.mermaid) {
  mermaid.initialize({
    startOnLoad: true,
    theme: '[object Object]',
    securityLevel: 'loose',
    flowchart: { useMaxWidth: true, htmlLabels: true }
  });
}</script></div></footer></div><div id="rightside"><div id="rightside-config-hide"><a class="icon-V hidden" onclick="switchNightMode()" title="日间和夜间模式切换"><svg width="25" height="25" viewBox="0 0 1024 1024"><use id="modeicon" xlink:href="#icon-moon"></use></svg></a><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><a id="to_comment" href="#post-comment" title="前往评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><div class="js-pjax"><script>(() => {
  const runMermaid = ele => {
    window.loadMermaid = true
    const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

    ele.forEach((item, index) => {
      const mermaidSrc = item.firstElementChild
      const mermaidThemeConfig = `%%{init:{ 'theme':'${theme}'}}%%\n`
      const mermaidID = `mermaid-${index}`
      const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent

      const renderFn = mermaid.render(mermaidID, mermaidDefinition)
      const renderMermaid = svg => {
        mermaidSrc.insertAdjacentHTML('afterend', svg)
      }

      // mermaid v9 and v10 compatibility
      typeof renderFn === 'string' ? renderMermaid(renderFn) : renderFn.then(({ svg }) => renderMermaid(svg))
    })
  }

  const codeToMermaid = () => {
    const codeMermaidEle = document.querySelectorAll('pre > code.mermaid')
    if (codeMermaidEle.length === 0) return

    codeMermaidEle.forEach(ele => {
      const preEle = document.createElement('pre')
      preEle.className = 'mermaid-src'
      preEle.hidden = true
      preEle.textContent = ele.textContent
      const newEle = document.createElement('div')
      newEle.className = 'mermaid-wrap'
      newEle.appendChild(preEle)
      ele.parentNode.replaceWith(newEle)
    })
  }

  const loadMermaid = () => {
    if (true) codeToMermaid()
    const $mermaid = document.querySelectorAll('#article-container .mermaid-wrap')
    if ($mermaid.length === 0) return

    const runMermaidFn = () => runMermaid($mermaid)
    btf.addGlobalFn('themeChange', runMermaidFn, 'mermaid')
    window.loadMermaid ? runMermaidFn() : btf.getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(runMermaidFn)
  }

  btf.addGlobalFn('encrypt', loadMermaid, 'mermaid')
  window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
})()</script><script>(() => {
  const isShuoshuo = GLOBAL_CONFIG_SITE.pageType === 'shuoshuo'
  const option = null

  const getGiscusTheme = theme => theme === 'dark' ? 'dark' : 'light'

  const createScriptElement = config => {
    const ele = document.createElement('script')
    Object.entries(config).forEach(([key, value]) => {
      ele.setAttribute(key, value)
    })
    return ele
  }

  const loadGiscus = (el = document, key) => {
    const mappingConfig = isShuoshuo
      ? { 'data-mapping': 'specific', 'data-term': key }
      : { 'data-mapping': (option && option['data-mapping']) || 'pathname' }

    const giscusConfig = {
      src: 'https://giscus.app/client.js',
      'data-repo': 'pengline/pengline.github.io',
      'data-repo-id': 'R_kgDOPqG50w',
      'data-category-id': 'DIC_kwDOPqG5084Cu_K9',
      'data-theme': getGiscusTheme(document.documentElement.getAttribute('data-theme')),
      'data-reactions-enabled': '1',
      crossorigin: 'anonymous',
      'data-lang': 'zh-CN',
      'data-input-position': 'top',
      async: true,
      ...option,
      ...mappingConfig
    }

    const scriptElement = createScriptElement(giscusConfig)

    el.querySelector('#giscus-wrap').appendChild(scriptElement)

    if (isShuoshuo) {
      window.shuoshuoComment.destroyGiscus = () => {
        if (el.children.length) {
          el.innerHTML = ''
          el.classList.add('no-comment')
        }
      }
    }
  }

  const changeGiscusTheme = theme => {
    const iframe = document.querySelector('#giscus-wrap iframe')
    if (iframe) {
      const message = {
        giscus: {
          setConfig: {
            theme: getGiscusTheme(theme),
            lang: 'zh-CN'
          }
        }
      }
      iframe.contentWindow.postMessage(message, 'https://giscus.app')
    }
  }

  btf.addGlobalFn('themeChange', changeGiscusTheme, 'giscus')

  if (isShuoshuo) {
    'Giscus' === 'Giscus'
      ? window.shuoshuoComment = { loadComment: loadGiscus }
      : window.loadOtherComment = loadGiscus
    return
  }

  if ('Giscus' === 'Giscus' || !false) {
    if (false) btf.loadComment(document.getElementById('giscus-wrap'), loadGiscus)
    else loadGiscus()
  } else {
    window.loadOtherComment = loadGiscus
  }
})()</script></div><script src="/js/custom/sun_moon.js" async></script><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="true" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-nest.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>